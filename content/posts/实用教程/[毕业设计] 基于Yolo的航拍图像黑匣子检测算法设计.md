---
password: ""
icon: ""
date: "2024-03-01"
type: Post
category: åŠ¨æ‰‹å®è·µ
slug: Graduation-Design
tags:
  - å®ç”¨æ•™ç¨‹
summary: è¿™ç¯‡æ–‡ç« éšè¿›åº¦æ›´æ–°ï¼Œç”¨äºè®°å½•åœ¨æ¯•è®¾è¿‡ç¨‹ä¸­é‡åˆ°çš„å¿ƒå¾—å’Œé—®é¢˜ã€‚
title: "[æ¯•ä¸šè®¾è®¡] åŸºäºYoloçš„èˆªæ‹å›¾åƒé»‘åŒ£å­æ£€æµ‹ç®—æ³•è®¾è®¡"
status: Published
urlname: 4953c12f-b064-475e-aa3b-1a7019651192
updated: "2024-03-26 16:10:00"
---

# å‰è¨€

---

> ğŸ’¡ é¦–å…ˆéœ€è¦æ„Ÿè°¢å­¦æ ¡ä¸ºæˆ‘ä»¬æä¾›çš„ä¸€ä¸ªè‰¯å¥½çš„å­¦ä¹ å¹³å°ï¼Œè®©æˆ‘ä»¬é€šè¿‡æ¯•è®¾æ¥äº†è§£é¡¹ç›®å¼€å‘çš„æµç¨‹ï¼Œå¹¶é€šè¿‡æ ‡å‡†åŒ–çš„ä¹¦å†™æ¥è§„èŒƒæ ¼å¼ã€‚æ„Ÿè°¢ç½—è€å¸ˆçš„è€å¿ƒæŒ‡å¯¼å’Œå¸®åŠ©ï¼Œåœ¨å®é™…æ¯•è®¾çš„å†™ä½œè¿‡ç¨‹ä¸­ï¼Œå…³æ³¨ç€æˆ‘ä»¬çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ã€‚  
>  åŒæ—¶éœ€è¦æ„Ÿè°¢å…¬å¸[Andawell](http://www.andawell.com/)çš„æ”¯æŒï¼Œèƒ½ä¸ºæˆ‘æä¾›åœ¨å…¬å¸è¾¹å®ä¹ è¾¹åšæ¯•è®¾çš„æœºä¼šã€‚åŒæ—¶èƒ½å°†æ¯•è®¾ä¸é¡¹ç›®å¼€å‘çš„æ ‡å‡†æ›´å¥½åœ°ç»“åˆã€‚  
>  æœ€åè¿˜éœ€è¦é¼“åŠ±è‡ªå·±ï¼Œå› ä¸ºéœ€è¦ä»˜å‡ºå¾ˆå¤šçš„åŠªåŠ›ã€‚

# æ­£æ–‡

---

ä¸€æ–¹é¢ä¸»è¦æ˜¯æŠ€æœ¯ä¸Šçš„è¦æ±‚ï¼Œä¸€æ–¹é¢ä¸»è¦æ˜¯è®ºæ–‡ä¸Šçš„æ’ç‰ˆã€‚ç„¶åå¸Œæœ›æˆ‘é‡åˆ°çš„é—®é¢˜ï¼Œä¹Ÿèƒ½å¸®åˆ°å¤§å®¶ã€‚

## **word ä¸­ mathtype å…¬å¼åä¸Šæµ®æˆ–åä¸‹æ²‰æ€ä¹ˆåŠ**

---

åˆšæ‰é‡åˆ°äº†å…¬å¼ä¸Šæµ®çš„é—®é¢˜ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯ amath è¿›è¡Œå…¬å¼çš„ç¼–å†™ï¼Œæ­é…å›¾ç‰‡è½¬ latex è¿›è¡Œè°ƒæ•´ã€‚ç„¶åæ‰¾åˆ°äº†è¿™ä¸ªé—®é¢˜çš„è§£å†³åŠæ³•ã€‚æ„Ÿè°¢ whu æ•°ç å›æä¾›çš„[å›ç­”](https://jingyan.baidu.com/article/09ea3edef9845480aede39a5.html)ã€‚

## å¦‚ä½•ä½¿ç”¨å›¾ç‰‡è½¬ latex

---

ä¹‹å‰æœ‰åŒå­¦é—®è¿‡æˆ‘è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»Šå¤©ä¹Ÿå†ä¸€æ¬¡é‡åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œçœ‹åˆ°è®ºæ–‡ä¸­å¤æ‚çš„å…¬å¼ï¼Œä¸€ç­¹è«å±•æ€ä¹ˆåŠï¼Œå¯ä»¥é€šè¿‡å›¾ç‰‡è½¬ latex çš„æ–¹å¼ï¼Œè¿™æ˜¯æˆ‘æ¯”è¾ƒå¸¸ç”¨çš„æ–¹å¼ï¼Œä½†æ˜¯ç°åœ¨ä¸»æµçš„è½¬ latex çš„å¥½çš„è½¯ä»¶ä¸å¤šï¼Œåœ¨æ­¤ç‰¹åˆ«æ„Ÿè°¢[simpletex](https://simpletex.cn/ai/latex_ocr)æä¾›çš„æ”¯æŒã€‚

## å…³äºè¯­ç—…çš„ä¿®æ”¹

---

æ„Ÿè°¢ up ä¸»ï¼š[ç”¨é•œå¤´è®°å½•æˆé•¿](https://space.bilibili.com/26021795)ï¼Œå‚è€ƒ[è®ºæ–‡å†™ä½œè¡¨è¾¾è¯­å¥è¡¨è¾¾ç³»åˆ—è¯¾ç¨‹ ä¸€ ç—…å¥ä¿®æ”¹ æˆåˆ†æ®‹ç¼º\_å“”å“©å“”å“©\_bilibili](https://www.bilibili.com/video/BV1PB4y1U7JU/?buvid=XYA9A96A2DBF2E51A918ECE55EFA494C98935&is_story_h5=false&mid=nPIoZdTfuXw2Qtcat9xxZw%3D%3D&p=1&plat_id=114&share_from=ugc&share_medium=android&share_plat=android&share_session_id=e1117509-5d59-4fd0-b122-21d23e500899&share_source=WEIXIN&share_tag=s_i&timestamp=1693714483&unique_k=HFqrbnI&up_id=26021795&share_times=1&vd_source=237e295a40d7aaea043ead8c0d2c78ab)è¯¥è§†é¢‘è¿›è¡Œæ€»ç»“ã€‚

<details>
  <summary>  ä»¥ä¸‹å†…å®¹æ˜¯å¯¹è¯¥è§†é¢‘è¿›è¡Œçš„ç¬”è®°æ¢³ç†ã€‚</summary>

### ä¸€ã€ä¸»è¯­æ®‹ç¼º

---

- **æ»¥ç”¨ä»‹è¯**

> ä»è¿™ä»¶å°äº‹ï¼Œè¯´æ˜ä¸€ä¸ªé“ç†

åº”æ”¹ä¸ºï¼Œè¿™ä»¶å°äº‹è¯´æ˜ä¸€ä¸ªé“ç†ã€‚ä¸Šè¿°ä¾‹å­ä¸­ç¼ºå°‘ä¸»è¯­ã€‚

> å½“å­¦ç”Ÿäº†è§£äº†ç¾æ˜¯ä»€ä¹ˆï¼Œå°±ä¼šä»¥ç¾çš„æ ‡å‡†ç±³è§„èŒƒè‡ªå·±çš„è¡Œä¸ºå’Œæ€æƒ³ã€‚

åº”å»é™¤â€œå½“â€å­—ã€‚

- **æ»¥ç”¨ä½¿ä»¤åŠ¨è¯**

> é€šè¿‡è¿™ä»¶å°äº‹ï¼Œä½¿æˆ‘æ˜ç™½äº†ä¸€ä¸ªé“ç†ã€‚

å»é™¤â€é€šè¿‡â€œäºŒå­—ã€‚

> é€šè¿‡å¯¹è¯¥è¯¾é¢˜çš„ç ”ç©¶ï¼Œå¾—å‡ºæ–°æ—¶ä»£ç²¾ç¥çš„å«ä¹‰ã€‚

éœ€æ·»åŠ ä¸»è¯­ï¼Œä¾‹å¦‚â€œç¬”è€…å¾—å‡ºâ€¦â€¦â€**(å¦å¤–è¿˜éœ€è¦å°½é‡é¿å…åœ¨è®ºæ–‡ä¸­ä½¿ç”¨â€œæˆ‘â€å­—)**

- **åæ­£çŸ­è¯­ç¼ºä¸­å¿ƒè¯­**

> è¯¾å ‚æ•™å­¦ä½æ•ˆï¼Œä¸€ç›´æœªå¾—åˆ°è§£å†³ã€‚

éœ€åœ¨â€ä½æ•ˆâ€œåé¢åŠ ä¸Šâ€çš„é—®é¢˜â€œ

> æˆ‘å¯¹ç»æµä¸ç”Ÿæ´»è¿™æœ¬æ•™ææ„Ÿåˆ°å›°æ„Ÿã€‚

éœ€åœ¨â€œæ•™æâ€åé¢åŠ ä¸Šâ€œçš„å†…å®¹â€

- **æ»¥ç”¨çœç•¥**

> åœ¨ç»å†äº†å‡ åƒå¹´çš„å°å»ºç»Ÿæ²»åï¼Œäººä»¬åˆå¼€å§‹é‡è§†è¢«ç¦é”¯çš„å¤å…¸æ–‡åŒ–ï¼Œå¹¶æˆä¸ºäººæ–‡ä¸»ä¹‰è€…çš„æ­¦å™¨ï¼Œç”¨ç±³åå¯¹ç¥æƒã€‚

åº”æ”¹ä¸ºâ€å¤å…¸æ–‡åŒ–å¹¶æˆä¸ºäººæ–‡ä¸»ä¹‰è€…çš„æ­¦å™¨â€œ

- **åŠ©è¯ç”¨é”™**

> 2022 å¹´é¢å¸ƒäº†ã€Šå®¶åº­æ•™è‚²æŒ‡å¯¼æ³•ã€‹ï¼Œæ˜¯æˆ‘å›½é¦–éƒ¨å®¶åº­æ•™è‚²æ³•ã€‚

æŠŠâ€œäº†â€æ”¹æˆâ€œçš„â€

### äºŒã€è°“è¯­æ®‹ç¼º

---

- **å¥é¦–ç¼ºè°“å¦èµ·å¤´**

> ç»è¿‡å‡ åå¹´çš„åŠªåŠ›ï¼Œæˆ‘å›½å·±ç»ç‹¬ç«‹è‡ªä¸»åœ°ç ”åˆ¶ã€å‘å°„ã€è·Ÿè¸ªå’Œæµ‹æ£€åœ°çƒåŒæ­¥é€šè®¯å«æ˜Ÿçš„èƒ½åŠ›ã€‚

å…·å¤‡â€¦â€¦çš„èƒ½åŠ›

> æŸå¤§å­¦å·¥å•†ç®¡ç†å­¦é™¢åœ¨è¯¾ç¨‹è®¾ç½®ä¸Šé™¤äº†ä¸“ä¸šè¯¾ã€å¤–è¯­è¯¾ã€æ”¿æ²»ç†è®ºè¯¾ï¼Œè¿˜åŒ…æ‹¬æ¼”è®²ä¸å£æ‰ã€åŸºç¡€å†™ä½œç­‰è¯¾ç¨‹ï¼Œä»¥è¿›ä¸€æ­¥æé«˜è¯´å†™æ–¹é¢çš„æŠ€èƒ½ã€‚

é™¤äº†è®¾ç½®æœ‰â€¦â€¦ **(ç¬¬ä¸€å¥è¯ç¼ºå°‘è°“è¯­)**

- **åŠ¨å®¾ç¼ºåŠ¨**

> æˆ‘å¸‚æœ€è¿‘å‘åŠ¨äº†å…¨é¢çš„è´¨é‡å¤§æ£€æŸ¥è¿åŠ¨ï¼Œè¦åœ¨è¿™ä¸ªè¿åŠ¨ä¸­å»ºç«‹ä¸åŠ å¼ºæŠ€æœ¯ç®¡ç†åˆ¶åº¦ç­‰ä¸€ç³»åˆ—å·¥ä½œã€‚

è¦åœ¨è¿™ä¸ªè¿åŠ¨ä¸­**å®Œæˆ**å»ºç«‹ä¸åŠ å¼ºæŠ€æœ¯ç®¡ç†åˆ¶åº¦ç­‰ä¸€ç³»åˆ—**å·¥ä½œ**

> æ”¿åºœå¿…é¡»ä¸¥å‰æ‰“å‡»é£Ÿå“å®‰å…¨è¿æ³•è¿è§„è¡Œä¸ºçš„é«˜å‹æ€åŠ¿ï¼ŒåŠæ—¶æ¶ˆé™¤å„ç¯èŠ‚é¢†åŸŸçš„éšæ‚£ï¼Œåˆ›æ–°é£Ÿå“å®‰å…¨ç›‘ç®¡æƒ©å¤„ä½“åˆ¶æœºåˆ¶ã€‚

ä¿æŒä¸¥å‰æ‰“å‡»â€¦

> æ•™å¸ˆåœ¨æ³•å¾‹ä¸“ä¸šçŸ¥è¯†å’Œé€»è¾‘æ€ç»´èƒ½åŠ›æå‡æ–¹é¢é¢ä¸´å›°éš¾ã€‚

æ•™å¸ˆåœ¨æ³•å¾‹ä¸“ä¸šçŸ¥è¯†æ‹“å±•â€¦ (çŸ¥è¯†å’Œæå‡æ­é…ä¸æ˜¯éå¸¸å¥½ï¼Œæ­é…çŸ¥è¯†æ‹“å±•å¯èƒ½ä¼šæ›´å¥½)

### ä¸‰ã€å®¾è¯­æ®‹ç¼º

---

- **åŠ¨å®¾ç¼ºå®¾**

> å­¦æ ¡å®¿èˆã€æ•™å­¦æ¥¼ç­‰äººç¾¤å¯†é›†åŒºï¼Œä¸€ä¸”å‘ç”Ÿç«ç¾ï¼Œåæœä¸å ªè®¾æƒ³ï¼Œå› æ­¤å­¦ç”ŸæŒæ¡ç«ç¾ä¸­è‡ªæ•‘äº’æ•™ç›¸å½“é‡è¦ã€‚

æŒæ¡â€¦æŠ€èƒ½

- **ä»‹å®¾ç¼ºå®¾**

> è¿™éƒ¨ç”µå½±åœ¨å¡‘é€ äººç‰©å½¢è±¡æ‰€æä¾›çš„ç»éªŒæ˜¯éå¸¸å®è´µçš„ï¼Œ

åœ¨â€¦æ–¹é¢

- **è¯¯å°†å®šè¯­å½“å®¾è¯­**

> æ¡ƒèŠ±ä¹¡èµ°å¯æŒç»­å‘å±•ä¹‹è·¯ï¼ŒæŒ‰ç…§å»ºæˆç”Ÿæ€ç¯å¢ƒå’Œè°ä¼˜ç¾ã€èµ„æºé›†çº¦èŠ‚çº¦åˆ©ç”¨ã€ç»æµå’Œç¤¾ä¼šåè°ƒå‘å±•çš„ç”Ÿæ€ä¹¡ï¼Œåˆ¶å®šäº†äº”å¹´å‘å±•å»ºè®¾è§„åˆ’ã€‚

æŒ‰ç…§â€¦ç›®æ ‡ï¼Œè§„åˆ’

### å››ã€è™šè¯æ®‹ç¼º

---

- **ä»‹å®¾ç¼ºä»‹**

> 2014 å¹´åº•ï¼Œæˆ‘å›½æ¢æœˆå·¥ç¨‹ä¸‰æœŸâ€œå†å…¥è¿”å›é£è¡Œâ€è¯•éªŒè·å¾—æˆåŠŸï¼Œç¡®ä¿å«¦å¨¥äº”å·ä»»åŠ¡é¡ºåˆ©å®æ–½å’Œæ¢æœˆå·¥ç¨‹æŒç»­æ¨è¿›è«å®šåšå®åŸºç¡€ï¼Œ

ä¸ºâ€¦å¥ å®šåšå®åŸºç¡€

- **è¢«åŠ¨ç¼ºè¢«**

> è¿™æœ¬ä¹¦éå¸¸æœ‰ä»·å€¼ï¼Œå¸¸å¸¸å›¾ä¹¦é¦†æ”¶è—ã€‚

å¸¸å¸¸è¢«å›¾ä¹¦é¦†æ”¶è—

- **å¯¹è±¡ç¼ºå¯¹**

> ç°ä»£å¥³æ€§è¶Šæ¥è¶Šç‹¬ç«‹ï¼Œå¥¹ä»¬é™¤äº†è‡ªå·±ç‹¬ç«‹æŒ£é’±å¤–ï¼Œå¯¹è‡ªèº«çš„ä»·å€¼ã€ç”Ÿæ´»ç¯å¢ƒä¹Ÿè¶Šå‘é‡è§†ï¼Œé‚£äº›ä»·å€¼å‰¥å‰Šã€æ€§éªšæ‰°ï¼Œå¥¹ä»¬å°†è¯´ä¸ã€‚

å¯¹é‚£äº›ä»·å€¼å‰¥å‰Šã€æ€§éªšæ‰°ï¼Œå¥¹ä»¬å°†è¯´ä¸ã€‚

  </details>

## æ­å»º yolov5 ç¯å¢ƒ

---

è¯¦ç»†å‚ç…§ up ä¸»ï¼š[**æ€ç»ªäº¦æ— é™**](https://space.bilibili.com/456667721)çš„ä»‹ç»ï¼š

[**Win11 ä¸­ä»å¤´å®‰è£…è½¯ä»¶å’Œé…ç½®ç¯å¢ƒè¿è¡Œæ·±åº¦å­¦ä¹ é¡¹ç›®**](https://www.bilibili.com/video/BV1Hg4y1t78v/?spm_id_from=333.999.0.0&vd_source=237e295a40d7aaea043ead8c0d2c78ab)

ç„¶åæœ€ä¸»è¦çš„è¿˜éœ€è¦å¼•å…¥è‹±ä¼Ÿè¾¾çš„ CUDAï¼Œå¯ä»¥ç°åœ¨æœ¬åœ°è£…ï¼Œä½†æˆ‘è¿˜æ˜¯å€¾å‘äºé€‰æ‹©[autodl](https://www.autodl.com/home)ï¼Œå› ä¸ºè¿™é‡Œå·²ç»é¢„è£…äº† cuda ç¯å¢ƒã€‚

è¿™é‡Œç»†èŠ‚å¾ˆå¤šï¼Œä½†ç°åœ¨åˆè¿‡äº†å¥½ä¹…äº†ï¼Œ**æœ‰ç‚¹å¿˜äº†**ï¼Œåœ¨é€‰æ‹©åŸºç¡€é•œåƒçš„æ—¶å€™å°±åº”è¯¥è¦æ³¨æ„é€‰æ‹©åˆé€‚çš„ç‰ˆæœ¬ï¼Œä¸ç„¶åé¢é…ç½® cuda ä¼šéº»çƒ¦æ­»ã€‚ï¼ˆçœ‹æ¥æ—¥å¿—è¿˜æ˜¯è¦å³ä½¿è®°å½•ï¼Œå½“æ—¶è´¹äº†ä¸€ä¸‹åˆçš„åŠ²ï¼ŒçœŸæ˜¯æœäº†ï¼‰

## æ•°æ®é›†çš„é¢„å¤„ç†

---

è¯¾é¢˜ä¸­ yolov5 çš„æ•°æ®é›†æ˜¯é‡‡ç”¨çš„èˆªæ‹è§†è§’ï¼Œå’Œæˆ‘å½“æ—¶è¯¾è®¾åšå¾—å¾ˆä¸ä¸€æ ·ï¼Œä¸€å¼  4K çš„å›¾åå‡ å…†ï¼Œç›´æ¥è¯»å–æä¸ºä¸ç°å®ï¼Œå°±å’Œèš‚èšä¸€æ ·ï¼Œè¿˜æœ‰å¾ˆå¤šå¹²æ‰°ï¼Œä¸å¥½åŠã€‚æ‰€ä»¥éœ€è¦é¢„å…ˆå¯¹æ•°æ®é›†è¿›è¡Œåˆ‡ç‰‡å¤„ç†ã€‚

ç„¶åæŒ‘å‡ºåˆ‡ç‰‡å®ŒååŒ…å«é»‘åŒ£å­çš„å›¾ç‰‡ï¼Œå†è¿›è¡Œæ ‡æ³¨ã€‚

## éªŒè¯é›†

---

æœ€å¼€å§‹éªŒè¯é›†æ˜¯ç”¨çš„æ•°æ®é›†çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯åé¢é‡‡ç”¨æ–°çš„éªŒè¯é›†ï¼Œéš¾åº¦ç¬é—´å°±ä¸Šæ¥äº†ï¼Œæµ‹è¯•ç²¾åº¦ä» 0.996 ç¬é—´è·Œåˆ°éƒ½åˆ°ä¸äº† 0.7ã€‚

ç„¶åé—®é¢˜å°±æ¥äº†ï¼Œä¸€æ–¹é¢éœ€è¦æ‰©å……æ•°æ®é›†ï¼Œå¦ä¸€æ–¹é¢éœ€è¦é€‰æ‹©åˆé€‚çš„æ¨¡å‹å¯¹ç½‘ç»œå‚æ•°çš„æŒ‘æˆ˜ã€‚

### æ‰©å……éªŒè¯é›†

---

æ„Ÿè°¢ CSDN åšä¸»ï¼š[**æˆ‘è¦å˜èƒ–å“‡**](https://blog.csdn.net/qq_44421796)**ã€**[**è·¯äººè´¾'Ï‰'**](https://blog.csdn.net/weixin_43334693)

å‚è€ƒæ–‡ç« ï¼š[**YOLO æ•°æ®é›†å®ç°æ•°æ®å¢å¼ºçš„æ–¹æ³•ï¼ˆè£å‰ªã€å¹³ç§» ã€æ—‹è½¬ã€æ”¹å˜äº®åº¦ã€åŠ å™ªå£°ç­‰ï¼‰**](https://blog.csdn.net/weixin_43334693/article/details/131744918)

<details>
  <summary>æ•°æ®å¢å¼ºçš„æ¦‚å¿µ</summary>

**æ•°æ®å¢å¼º**æ˜¯ä¸€ç§é‡è¦çš„æœºå™¨å­¦ä¹ æ–¹æ³•ä¹‹ä¸€ï¼Œæ˜¯**åŸºäºå·²æœ‰çš„è®­ç»ƒæ ·æœ¬æ•°æ®æ¥ç”Ÿæˆæ›´å¤šçš„è®­ç»ƒæ•°æ®**ï¼Œå…¶ç›®çš„å°±æ˜¯**ä¸ºäº†ä½¿æ‰©å¢çš„è®­ç»ƒæ•°æ®å°½å¯èƒ½æ¥è¿‘çœŸå®åˆ†å¸ƒçš„æ•°æ®ï¼Œä»è€Œæé«˜æ£€æµ‹ç²¾åº¦**ã€‚æ­¤å¤–ï¼Œæ•°æ®å¢å¼ºèƒ½å¤Ÿè¿«ä½¿æ¨¡å‹**å­¦ä¹ åˆ°æ›´å¤šé²æ£’æ€§çš„ç‰¹å¾ï¼Œä»è€Œæœ‰æ•ˆæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›**ã€‚

åœ¨å®é™…çš„åº”ç”¨åœºæ™¯ä¸­ï¼Œè¶³é‡ä¸”é«˜ä¿çœŸçš„ä¼˜è´¨æ•°æ®é›†é€šå¸¸æ˜¯å¯é‡ä¸å¯æ±‚çš„ï¼Œè¿™ä¸ä»…**è´¹é’±è´¹æ—¶è´¹åŠ›ï¼Œè€Œä¸”éšç§ä¿æŠ¤å’Œæç«¯æ¦‚ç‡é—®é¢˜ï¼Œæ•°æ®é›†çš„è·å–å˜å¾—å°¤ä¸ºå›°éš¾**ã€‚å› æ­¤ï¼Œä¸€ç§ä½æˆæœ¬ä¸”æœ‰æ•ˆçš„æ–¹æ³•ä¾¿æ˜¯**åˆ©ç”¨æ•°æ®å¢å¼ºæ¥å‡å°‘å¯¹è®­ç»ƒæ•°æ®çš„ä¾èµ–**ï¼Œä»è€Œå¸®åŠ©å¼€å‘äººå‘˜æ›´å¥½æ›´å¿«åœ°æ„å»ºé«˜ç²¾åº¦çš„ AI æ¨¡å‹ã€‚

  </details>

<details>
  <summary>æ•°æ®å¢å¼ºçš„ä½œç”¨</summary>

**ï¼ˆ1ï¼‰ é¿å…è¿‡æ‹Ÿåˆã€‚**å½“æ•°æ®é›†å…·æœ‰æŸç§æ˜æ˜¾çš„ç‰¹å¾ï¼Œä¾‹å¦‚æ•°æ®é›†ä¸­å›¾ç‰‡åŸºæœ¬åœ¨åŒä¸€ä¸ªåœºæ™¯ä¸­æ‹æ‘„ï¼Œä½¿ç”¨ Cutout æ–¹æ³•å’Œé£æ ¼è¿ç§»å˜åŒ–ç­‰ç›¸å…³æ–¹æ³•å¯é¿å…æ¨¡å‹å­¦åˆ°è·Ÿç›®æ ‡æ— å…³çš„ä¿¡æ¯ã€‚

**ï¼ˆ2ï¼‰æå‡æ¨¡å‹é²æ£’æ€§ï¼Œé™ä½æ¨¡å‹å¯¹å›¾åƒçš„æ•æ„Ÿåº¦ã€‚**å½“è®­ç»ƒæ•°æ®éƒ½å±äºæ¯”è¾ƒç†æƒ³çš„çŠ¶æ€ï¼Œç¢°åˆ°ä¸€äº›ç‰¹æ®Šæƒ…å†µï¼Œå¦‚é®æŒ¡ï¼Œäº®åº¦ï¼Œæ¨¡ç³Šç­‰æƒ…å†µå®¹æ˜“è¯†åˆ«é”™è¯¯ï¼Œå¯¹è®­ç»ƒæ•°æ®åŠ ä¸Šå™ªå£°ï¼Œæ©ç ç­‰æ–¹æ³•å¯æå‡æ¨¡å‹é²æ£’æ€§ã€‚

**ï¼ˆ3ï¼‰å¢åŠ è®­ç»ƒæ•°æ®ï¼Œæé«˜æ¨¡å‹æ³›åŒ–èƒ½åŠ›ã€‚**

**ï¼ˆ4ï¼‰é¿å…æ ·æœ¬ä¸å‡è¡¡ã€‚**åœ¨å·¥ä¸šç¼ºé™·æ£€æµ‹æ–¹é¢ï¼ŒåŒ»ç–—ç–¾ç—…è¯†åˆ«æ–¹é¢ï¼Œå®¹æ˜“å‡ºç°æ­£è´Ÿæ ·æœ¬æåº¦ä¸å¹³è¡¡çš„æƒ…å†µï¼Œé€šè¿‡å¯¹å°‘æ ·æœ¬è¿›è¡Œä¸€äº›æ•°æ®å¢å¼ºæ–¹æ³•ï¼Œé™ä½æ ·æœ¬ä¸å‡è¡¡æ¯”ä¾‹ã€‚

  </details>

<details>
  <summary>å¸¸è§çš„æ•°æ®å¢å¼ºçš„åŠæ³•</summary>

ï¼ˆ1ï¼‰æ¯”è¾ƒå¸¸ç”¨çš„**å‡ ä½•å˜æ¢**æ–¹æ³•ä¸»è¦æœ‰ï¼š

- ç¿»è½¬
- æ—‹è½¬
- è£å‰ª
- ç¼©æ”¾
- å¹³ç§»
- æŠ–åŠ¨

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨æŸäº›å…·ä½“çš„ä»»åŠ¡ä¸­ï¼Œå½“ä½¿ç”¨è¿™äº›æ–¹æ³•æ—¶éœ€è¦ä¸»è¦æ ‡ç­¾æ•°æ®çš„å˜åŒ–ï¼Œå¦‚ç›®æ ‡æ£€æµ‹ä¸­è‹¥ä½¿ç”¨ç¿»è½¬ï¼Œåˆ™éœ€è¦å°† gt æ¡†è¿›è¡Œç›¸åº”çš„è°ƒæ•´ã€‚

ï¼ˆ2ï¼‰æ¯”è¾ƒå¸¸ç”¨çš„**åƒç´ å˜æ¢**æ–¹æ³•ä¸»è¦æœ‰ï¼š

- åŠ æ¤’ç›å™ªå£°
- é«˜æ–¯å™ªå£°
- è¿›è¡Œé«˜æ–¯æ¨¡ç³Š
- è°ƒæ•´ HSV å¯¹æ¯”åº¦
- è°ƒèŠ‚äº®åº¦
- é¥±å’Œåº¦
- ç›´æ–¹å›¾å‡è¡¡åŒ–
- è°ƒæ•´ç™½å¹³è¡¡ç­‰

  </details>

### å®æ“æ€è·¯

---

1. txt è½¬ xml
2. è¯»å– xml è¿›è¡Œæ‰©å……
3. æ‰©å……å®Œçš„ xml è½¬ txt
4. æ‰“åŒ…æ•°æ®é›†ä¸Šä¼ æœåŠ¡å™¨

<details>
  <summary>è¿›è¡Œtxtè½¬xmlæ“ä½œï¼Œä»£ç å¦‚ä¸‹ï¼š</summary>

```python
# -*- coding: utf-8 -*-
import os
import cv2
from lxml.etree import Element, SubElement, tostring


def txt_xml(img_path, img_name, txt_path, img_txt, xml_path, img_xml):
    clas = []
    # è¯»å–txtçš„ä¿¡æ¯
    txt_img = os.path.join(txt_path, img_txt)

    # å›¾åƒçš„å®½åº¦å’Œé«˜åº¦
    imw = 640  # åº”å½“æ ¹æ®å®é™…å›¾ç‰‡å¤§å°è¿›è¡Œè°ƒæ•´
    imh = 640  # åº”å½“æ ¹æ®å®é™…å›¾ç‰‡å¤§å°è¿›è¡Œè°ƒæ•´

    with open(txt_img, "r") as f:
        for line in f.readlines():
            line = line.strip('\n')
            list = line.split(" ")
            print(list)
            clas.append(list)

    # åˆ›å»ºXMLæ–‡æ¡£çš„æ ¹èŠ‚ç‚¹å’Œç›¸å…³å­èŠ‚ç‚¹
        # åˆ›å»ºXMLæ–‡æ¡£çš„æ ¹èŠ‚ç‚¹
        node_root = Element('annotation')
        node_folder = SubElement(node_root, 'folder')
        node_folder.text = '1'
        node_filename = SubElement(node_root, 'filename')

        # å›¾åƒåç§°
        node_filename.text = img_name
        node_size = SubElement(node_root, 'size')
        node_width = SubElement(node_size, 'width')
        node_width.text = str(imw)
        node_height = SubElement(node_size, 'height')
        node_height.text = str(imh)
        node_depth = SubElement(node_size, 'depth')
        node_depth.text = '3'

    # éå†æ‰€æœ‰çš„æ ‡æ³¨ä¿¡æ¯å¹¶æ·»åŠ åˆ°XMLä¸­
        # éå†æ‰€æœ‰çš„æ ‡æ³¨ä¿¡æ¯
        for i in range(len(clas)):
            x_center_norm = float(clas[i][1])
            y_center_norm = float(clas[i][2])
            width_norm = float(clas[i][3])
            height_norm = float(clas[i][4])
            # è½¬æ¢å½’ä¸€åŒ–åæ ‡åˆ°åƒç´ åæ ‡
            x_center = x_center_norm * imw
            y_center = y_center_norm * imh
            width = width_norm * imw
            height = height_norm * imh
            # è®¡ç®—å¹¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²
            xmin = str(int(round(x_center - (width / 2))))
            ymin = str(int(round(y_center - (height / 2))))
            xmax = str(int(round(x_center + (width / 2))))
            ymax = str(int(round(y_center + (height / 2))))

            # åˆ›å»ºXMLèŠ‚ç‚¹å¹¶èµ‹å€¼
            node_object = SubElement(node_root, 'object')
            node_name = SubElement(node_object, 'name')
            node_name.text = str(clas[i][0])
            node_pose = SubElement(node_object, 'pose')
            node_pose.text = "Unspecified"
            node_truncated = SubElement(node_object, 'truncated')
            node_truncated.text = "0"
            node_difficult = SubElement(node_object, 'difficult')
            node_difficult.text = '0'
            node_bndbox = SubElement(node_object, 'bndbox')
            node_xmin = SubElement(node_bndbox, 'xmin')
            node_xmin.text = xmin
            node_ymin = SubElement(node_bndbox, 'ymin')
            node_ymin.text = ymin
            node_xmax = SubElement(node_bndbox, 'xmax')
            node_xmax.text = xmax
            node_ymax = SubElement(node_bndbox, 'ymax')
            node_ymax.text = ymax

    # å°†XMLå†…å®¹å†™å…¥æ–‡ä»¶
    xml = tostring(node_root, pretty_print=True)
    img_newxml = os.path.join(xml_path, img_xml)
    with open(img_newxml, 'wb') as file_object:
        file_object.write(xml)


if __name__ == "__main__":
    # å›¾åƒã€æ ‡æ³¨å’ŒXMLæ–‡ä»¶å¤¹æ‰€åœ¨ä½ç½®ã€æ›´æ¢è‡ªå·±çš„ç»å¯¹è·¯å¾„
    img_path = r"D:\@Graduation\enhance\data\images\train"
    txt_path = r"D:\@Graduation\enhance\data\labels\train"
    xml_path = r"D:\@Graduation\enhance\data\labels\xml"
    for img_name in os.listdir(img_path):
        img_base_name = os.path.splitext(img_name)[0]
        img_xml = img_base_name + ".xml"
        img_txt = img_base_name + ".txt"
        txt_xml(img_path, img_name, txt_path, img_txt, xml_path, img_xml)

```

  </details>

**æ ¸å¿ƒåŸç†è§£é‡Š**ï¼šå¦‚æœå›¾åƒçš„å¤§å°æ˜¯ 640x640 åƒç´ ï¼Œæ¢ç®—ä» YOLO æ ¼å¼åˆ° PASCAL VOC æ ¼å¼æ—¶ï¼Œä½ éœ€è¦ä½¿ç”¨è¿™ä¸ªå°ºå¯¸æ¥å°† YOLO æ ¼å¼ä¸­çš„å½’ä¸€åŒ–åæ ‡è½¬æ¢ä¸ºåƒç´ åæ ‡ã€‚

ä»¥ä¸‹æ˜¯è½¬æ¢çš„å…·ä½“æ­¥éª¤ï¼š

1. ä» YOLO æ ¼å¼çš„æ–‡æœ¬æ–‡ä»¶ä¸­è¯»å–æ¯ä¸ªç›®æ ‡çš„ç±»åˆ«ç´¢å¼•å’Œå½’ä¸€åŒ–çš„è¾¹ç•Œæ¡†åæ ‡ Â `(class_index, x_center_norm, y_center_norm, width_norm, height_norm)`ã€‚
2. å°†å½’ä¸€åŒ–çš„ä¸­å¿ƒç‚¹åæ ‡ Â `(x_center_norm, y_center_norm)`Â  å’Œå®½åº¦ã€é«˜åº¦ Â `(width_norm, height_norm)`Â  è½¬æ¢ä¸ºåƒç´ åæ ‡ã€‚
3. ä½¿ç”¨åƒç´ åæ ‡æ¥è®¡ç®— PASCAL VOC æ ¼å¼çš„è¾¹ç•Œæ¡† Â `(xmin, ymin, xmax, ymax)`

```python
# è®¡ç®— PASCAL VOC çš„ (xmin, ymin, xmax, ymax)
xmin = int(round(x_center - (width / 2)))
ymin = int(round(y_center - (height / 2)))
xmax = int(round(x_center + (width / 2)))
ymax = int(round(y_center + (height / 2)))
```

<details>
  <summary>è¿›è¡Œxmlæ‰©å……æ“ä½œ</summary>

```python
# -*- coding=utf-8 -*-

import time
import random
import copy
import cv2
import os
import math
import numpy as np
from skimage.util import random_noise
from lxml import etree, objectify
import xml.etree.ElementTree as ET
import argparse


# æ˜¾ç¤ºå›¾ç‰‡
def show_pic(img, bboxes=None):
    '''
    è¾“å…¥:
        img:å›¾åƒarray
        bboxes:å›¾åƒçš„æ‰€æœ‰boudning box list, æ ¼å¼ä¸º[[x_min, y_min, x_max, y_max]....]
        names:æ¯ä¸ªboxå¯¹åº”çš„åç§°
    '''
    for i in range(len(bboxes)):
        bbox = bboxes[i]
        x_min = bbox[0]
        y_min = bbox[1]
        x_max = bbox[2]
        y_max = bbox[3]
        cv2.rectangle(img, (int(x_min), int(y_min)), (int(x_max), int(y_max)), (0, 255, 0), 3)
    cv2.namedWindow('pic', 0)  # 1è¡¨ç¤ºåŸå›¾
    cv2.moveWindow('pic', 0, 0)
    cv2.resizeWindow('pic', 1200, 800)  # å¯è§†åŒ–çš„å›¾ç‰‡å¤§å°
    cv2.imshow('pic', img)
    cv2.waitKey(0)
    cv2.destroyAllWindows()


# å›¾åƒå‡ä¸ºcv2è¯»å–
class DataAugmentForObjectDetection():
    def __init__(self, rotation_rate=0.5, max_rotation_angle=5,
                 crop_rate=0.5, shift_rate=0.5, change_light_rate=0.5,
                 add_noise_rate=0.5, flip_rate=0.5,
                 cutout_rate=0.5, cut_out_length=50, cut_out_holes=1, cut_out_threshold=0.5,
                 is_addNoise=True, is_changeLight=True, is_cutout=True, is_rotate_img_bbox=True,
                 is_crop_img_bboxes=True, is_shift_pic_bboxes=True, is_filp_pic_bboxes=True):

        # é…ç½®å„ä¸ªæ“ä½œçš„å±æ€§
        self.rotation_rate = rotation_rate
        self.max_rotation_angle = max_rotation_angle
        self.crop_rate = crop_rate
        self.shift_rate = shift_rate
        self.change_light_rate = change_light_rate
        self.add_noise_rate = add_noise_rate
        self.flip_rate = flip_rate
        self.cutout_rate = cutout_rate

        self.cut_out_length = cut_out_length
        self.cut_out_holes = cut_out_holes
        self.cut_out_threshold = cut_out_threshold

        # æ˜¯å¦ä½¿ç”¨æŸç§å¢å¼ºæ–¹å¼
        self.is_addNoise = is_addNoise
        self.is_changeLight = is_changeLight
        self.is_cutout = is_cutout
        self.is_rotate_img_bbox = is_rotate_img_bbox
        self.is_crop_img_bboxes = is_crop_img_bboxes
        self.is_shift_pic_bboxes = is_shift_pic_bboxes
        self.is_filp_pic_bboxes = is_filp_pic_bboxes

    # ----1.åŠ å™ªå£°---- #
    def _addNoise(self, img):
        '''
        è¾“å…¥:
            img:å›¾åƒarray
        è¾“å‡º:
            åŠ å™ªå£°åçš„å›¾åƒarray,ç”±äºè¾“å‡ºçš„åƒç´ æ˜¯åœ¨[0,1]ä¹‹é—´,æ‰€ä»¥å¾—ä¹˜ä»¥255
        '''
        # return cv2.GaussianBlur(img, (11, 11), 0)
        return random_noise(img, mode='gaussian', seed=int(time.time()), clip=True) * 255

    # ---2.è°ƒæ•´äº®åº¦--- #
    def _changeLight(self, img):
        alpha = random.uniform(0.35, 1)
        blank = np.zeros(img.shape, img.dtype)
        return cv2.addWeighted(img, alpha, blank, 1 - alpha, 0)

    # ---3.cutout--- #
    def _cutout(self, img, bboxes, length=100, n_holes=1, threshold=0.5):
        '''
        åŸç‰ˆæœ¬ï¼šhttps://github.com/uoguelph-mlrg/Cutout/blob/master/util/cutout.py
        Randomly mask out one or more patches from an image.
        Args:
            img : a 3D numpy array,(h,w,c)
            bboxes : æ¡†çš„åæ ‡
            n_holes (int): Number of patches to cut out of each image.
            length (int): The length (in pixels) of each square patch.
        '''

        def cal_iou(boxA, boxB):
            '''
            boxA, boxBä¸ºä¸¤ä¸ªæ¡†ï¼Œè¿”å›iou
            boxBä¸ºbouding box
            '''
            # determine the (x, y)-coordinates of the intersection rectangle
            xA = max(boxA[0], boxB[0])
            yA = max(boxA[1], boxB[1])
            xB = min(boxA[2], boxB[2])
            yB = min(boxA[3], boxB[3])

            if xB <= xA or yB <= yA:
                return 0.0

            # compute the area of intersection rectangle
            interArea = (xB - xA + 1) * (yB - yA + 1)

            # compute the area of both the prediction and ground-truth
            # rectangles
            boxAArea = (boxA[2] - boxA[0] + 1) * (boxA[3] - boxA[1] + 1)
            boxBArea = (boxB[2] - boxB[0] + 1) * (boxB[3] - boxB[1] + 1)
            iou = interArea / float(boxBArea)
            return iou

        # å¾—åˆ°hå’Œw
        if img.ndim == 3:
            h, w, c = img.shape
        else:
            _, h, w, c = img.shape
        mask = np.ones((h, w, c), np.float32)
        for n in range(n_holes):
            chongdie = True  # çœ‹åˆ‡å‰²çš„åŒºåŸŸæ˜¯å¦ä¸boxé‡å å¤ªå¤š
            while chongdie:
                y = np.random.randint(h)
                x = np.random.randint(w)

                y1 = np.clip(y - length // 2, 0,
                             h)  # numpy.clip(a, a_min, a_max, out=None), clipè¿™ä¸ªå‡½æ•°å°†å°†æ•°ç»„ä¸­çš„å…ƒç´ é™åˆ¶åœ¨a_min, a_maxä¹‹é—´ï¼Œå¤§äºa_maxçš„å°±ä½¿å¾—å®ƒç­‰äº a_maxï¼Œå°äºa_min,çš„å°±ä½¿å¾—å®ƒç­‰äºa_min
                y2 = np.clip(y + length // 2, 0, h)
                x1 = np.clip(x - length // 2, 0, w)
                x2 = np.clip(x + length // 2, 0, w)

                chongdie = False
                for box in bboxes:
                    if cal_iou([x1, y1, x2, y2], box) > threshold:
                        chongdie = True
                        break
            mask[y1: y2, x1: x2, :] = 0.
        img = img * mask
        return img

    # ---4.æ—‹è½¬--- #
    def _rotate_img_bbox(self, img, bboxes, angle=5, scale=1.):
        '''
        å‚è€ƒ:https://blog.csdn.net/u014540717/article/details/53301195crop_rate
        è¾“å…¥:
            img:å›¾åƒarray,(h,w,c)
            bboxes:è¯¥å›¾åƒåŒ…å«çš„æ‰€æœ‰boundingboxs,ä¸€ä¸ªlist,æ¯ä¸ªå…ƒç´ ä¸º[x_min, y_min, x_max, y_max],è¦ç¡®ä¿æ˜¯æ•°å€¼
            angle:æ—‹è½¬è§’åº¦
            scale:é»˜è®¤1
        è¾“å‡º:
            rot_img:æ—‹è½¬åçš„å›¾åƒarray
            rot_bboxes:æ—‹è½¬åçš„boundingboxåæ ‡list
        '''
        # æ—‹è½¬å›¾åƒ
        w = img.shape[1]
        h = img.shape[0]
        # è§’åº¦å˜å¼§åº¦
        rangle = np.deg2rad(angle)  # angle in radians
        # now calculate new image width and height
        nw = (abs(np.sin(rangle) * h) + abs(np.cos(rangle) * w)) * scale
        nh = (abs(np.cos(rangle) * h) + abs(np.sin(rangle) * w)) * scale
        # ask OpenCV for the rotation matrix
        rot_mat = cv2.getRotationMatrix2D((nw * 0.5, nh * 0.5), angle, scale)
        # calculate the move from the old center to the new center combined
        # with the rotation
        rot_move = np.dot(rot_mat, np.array([(nw - w) * 0.5, (nh - h) * 0.5, 0]))
        # the move only affects the translation, so update the translation
        rot_mat[0, 2] += rot_move[0]
        rot_mat[1, 2] += rot_move[1]
        # ä»¿å°„å˜æ¢
        rot_img = cv2.warpAffine(img, rot_mat, (int(math.ceil(nw)), int(math.ceil(nh))), flags=cv2.INTER_LANCZOS4)

        # çŸ«æ­£bboxåæ ‡
        # rot_matæ˜¯æœ€ç»ˆçš„æ—‹è½¬çŸ©é˜µ
        # è·å–åŸå§‹bboxçš„å››ä¸ªä¸­ç‚¹ï¼Œç„¶åå°†è¿™å››ä¸ªç‚¹è½¬æ¢åˆ°æ—‹è½¬åçš„åæ ‡ç³»ä¸‹
        rot_bboxes = list()
        for bbox in bboxes:
            xmin = bbox[0]
            ymin = bbox[1]
            xmax = bbox[2]
            ymax = bbox[3]
            point1 = np.dot(rot_mat, np.array([(xmin + xmax) / 2, ymin, 1]))
            point2 = np.dot(rot_mat, np.array([xmax, (ymin + ymax) / 2, 1]))
            point3 = np.dot(rot_mat, np.array([(xmin + xmax) / 2, ymax, 1]))
            point4 = np.dot(rot_mat, np.array([xmin, (ymin + ymax) / 2, 1]))
            # åˆå¹¶np.array
            concat = np.vstack((point1, point2, point3, point4))
            # æ”¹å˜arrayç±»å‹
            concat = concat.astype(np.int32)
            # å¾—åˆ°æ—‹è½¬åçš„åæ ‡
            rx, ry, rw, rh = cv2.boundingRect(concat)
            rx_min = rx
            ry_min = ry
            rx_max = rx + rw
            ry_max = ry + rh
            # åŠ å…¥listä¸­
            rot_bboxes.append([rx_min, ry_min, rx_max, ry_max])

        return rot_img, rot_bboxes

    # ---5.è£å‰ª--- #
    def _crop_img_bboxes(self, img, bboxes):
        '''
        è£å‰ªåçš„å›¾ç‰‡è¦åŒ…å«æ‰€æœ‰çš„æ¡†
        è¾“å…¥:
            img:å›¾åƒarray
            bboxes:è¯¥å›¾åƒåŒ…å«çš„æ‰€æœ‰boundingboxs,ä¸€ä¸ªlist,æ¯ä¸ªå…ƒç´ ä¸º[x_min, y_min, x_max, y_max],è¦ç¡®ä¿æ˜¯æ•°å€¼
        è¾“å‡º:
            crop_img:è£å‰ªåçš„å›¾åƒarray
            crop_bboxes:è£å‰ªåçš„bounding boxçš„åæ ‡list
        '''
        # è£å‰ªå›¾åƒ
        w = img.shape[1]
        h = img.shape[0]
        x_min = w  # è£å‰ªåçš„åŒ…å«æ‰€æœ‰ç›®æ ‡æ¡†çš„æœ€å°çš„æ¡†
        x_max = 0
        y_min = h
        y_max = 0
        for bbox in bboxes:
            x_min = min(x_min, bbox[0])
            y_min = min(y_min, bbox[1])
            x_max = max(x_max, bbox[2])
            y_max = max(y_max, bbox[3])

        d_to_left = x_min  # åŒ…å«æ‰€æœ‰ç›®æ ‡æ¡†çš„æœ€å°æ¡†åˆ°å·¦è¾¹çš„è·ç¦»
        d_to_right = w - x_max  # åŒ…å«æ‰€æœ‰ç›®æ ‡æ¡†çš„æœ€å°æ¡†åˆ°å³è¾¹çš„è·ç¦»
        d_to_top = y_min  # åŒ…å«æ‰€æœ‰ç›®æ ‡æ¡†çš„æœ€å°æ¡†åˆ°é¡¶ç«¯çš„è·ç¦»
        d_to_bottom = h - y_max  # åŒ…å«æ‰€æœ‰ç›®æ ‡æ¡†çš„æœ€å°æ¡†åˆ°åº•éƒ¨çš„è·ç¦»

        # éšæœºæ‰©å±•è¿™ä¸ªæœ€å°æ¡†
        crop_x_min = int(x_min - random.uniform(0, d_to_left))
        crop_y_min = int(y_min - random.uniform(0, d_to_top))
        crop_x_max = int(x_max + random.uniform(0, d_to_right))
        crop_y_max = int(y_max + random.uniform(0, d_to_bottom))

        # éšæœºæ‰©å±•è¿™ä¸ªæœ€å°æ¡† , é˜²æ­¢åˆ«è£çš„å¤ªå°
        # crop_x_min = int(x_min - random.uniform(d_to_left//2, d_to_left))
        # crop_y_min = int(y_min - random.uniform(d_to_top//2, d_to_top))
        # crop_x_max = int(x_max + random.uniform(d_to_right//2, d_to_right))
        # crop_y_max = int(y_max + random.uniform(d_to_bottom//2, d_to_bottom))

        # ç¡®ä¿ä¸è¦è¶Šç•Œ
        crop_x_min = max(0, crop_x_min)
        crop_y_min = max(0, crop_y_min)
        crop_x_max = min(w, crop_x_max)
        crop_y_max = min(h, crop_y_max)

        crop_img = img[crop_y_min:crop_y_max, crop_x_min:crop_x_max]

        # è£å‰ªboundingbox
        # è£å‰ªåçš„boundingboxåæ ‡è®¡ç®—
        crop_bboxes = list()
        for bbox in bboxes:
            crop_bboxes.append([bbox[0] - crop_x_min, bbox[1] - crop_y_min, bbox[2] - crop_x_min, bbox[3] - crop_y_min])

        return crop_img, crop_bboxes

    # ---6.å¹³ç§»--- #
    def _shift_pic_bboxes(self, img, bboxes):
        '''
        å¹³ç§»åçš„å›¾ç‰‡è¦åŒ…å«æ‰€æœ‰çš„æ¡†
        è¾“å…¥:
            img:å›¾åƒarray
            bboxes:è¯¥å›¾åƒåŒ…å«çš„æ‰€æœ‰boundingboxs,ä¸€ä¸ªlist,æ¯ä¸ªå…ƒç´ ä¸º[x_min, y_min, x_max, y_max],è¦ç¡®ä¿æ˜¯æ•°å€¼
        è¾“å‡º:
            shift_img:å¹³ç§»åçš„å›¾åƒarray
            shift_bboxes:å¹³ç§»åçš„bounding boxçš„åæ ‡list
        '''
        # å¹³ç§»å›¾åƒ
        w = img.shape[1]
        h = img.shape[0]
        x_min = w  # è£å‰ªåçš„åŒ…å«æ‰€æœ‰ç›®æ ‡æ¡†çš„æœ€å°çš„æ¡†
        x_max = 0
        y_min = h
        y_max = 0
        for bbox in bboxes:
            x_min = min(x_min, bbox[0])
            y_min = min(y_min, bbox[1])
            x_max = max(x_max, bbox[2])
            y_max = max(y_max, bbox[3])

        d_to_left = x_min  # åŒ…å«æ‰€æœ‰ç›®æ ‡æ¡†çš„æœ€å¤§å·¦ç§»åŠ¨è·ç¦»
        d_to_right = w - x_max  # åŒ…å«æ‰€æœ‰ç›®æ ‡æ¡†çš„æœ€å¤§å³ç§»åŠ¨è·ç¦»
        d_to_top = y_min  # åŒ…å«æ‰€æœ‰ç›®æ ‡æ¡†çš„æœ€å¤§ä¸Šç§»åŠ¨è·ç¦»
        d_to_bottom = h - y_max  # åŒ…å«æ‰€æœ‰ç›®æ ‡æ¡†çš„æœ€å¤§ä¸‹ç§»åŠ¨è·ç¦»

        x = random.uniform(-(d_to_left - 1) / 3, (d_to_right - 1) / 3)
        y = random.uniform(-(d_to_top - 1) / 3, (d_to_bottom - 1) / 3)

        M = np.float32([[1, 0, x], [0, 1, y]])  # xä¸ºå‘å·¦æˆ–å³ç§»åŠ¨çš„åƒç´ å€¼,æ­£ä¸ºå‘å³è´Ÿä¸ºå‘å·¦; yä¸ºå‘ä¸Šæˆ–è€…å‘ä¸‹ç§»åŠ¨çš„åƒç´ å€¼,æ­£ä¸ºå‘ä¸‹è´Ÿä¸ºå‘ä¸Š
        shift_img = cv2.warpAffine(img, M, (img.shape[1], img.shape[0]))

        #  å¹³ç§»boundingbox
        shift_bboxes = list()
        for bbox in bboxes:
            shift_bboxes.append([bbox[0] + x, bbox[1] + y, bbox[2] + x, bbox[3] + y])

        return shift_img, shift_bboxes

    # ---7.é•œåƒ--- #
    def _filp_pic_bboxes(self, img, bboxes):
        '''
            å¹³ç§»åçš„å›¾ç‰‡è¦åŒ…å«æ‰€æœ‰çš„æ¡†
            è¾“å…¥:
                img:å›¾åƒarray
                bboxes:è¯¥å›¾åƒåŒ…å«çš„æ‰€æœ‰boundingboxs,ä¸€ä¸ªlist,æ¯ä¸ªå…ƒç´ ä¸º[x_min, y_min, x_max, y_max],è¦ç¡®ä¿æ˜¯æ•°å€¼
            è¾“å‡º:
                flip_img:å¹³ç§»åçš„å›¾åƒarray
                flip_bboxes:å¹³ç§»åçš„bounding boxçš„åæ ‡list
        '''
        # ç¿»è½¬å›¾åƒ

        flip_img = copy.deepcopy(img)
        h, w, _ = img.shape

        sed = random.random()

        if 0 < sed < 0.33:  # 0.33çš„æ¦‚ç‡æ°´å¹³ç¿»è½¬ï¼Œ0.33çš„æ¦‚ç‡å‚ç›´ç¿»è½¬,0.33æ˜¯å¯¹è§’åè½¬
            flip_img = cv2.flip(flip_img, 0)  # _flip_x
            inver = 0
        elif 0.33 < sed < 0.66:
            flip_img = cv2.flip(flip_img, 1)  # _flip_y
            inver = 1
        else:
            flip_img = cv2.flip(flip_img, -1)  # flip_x_y
            inver = -1

        # è°ƒæ•´boundingbox
        flip_bboxes = list()
        for box in bboxes:
            x_min = box[0]
            y_min = box[1]
            x_max = box[2]
            y_max = box[3]

            if inver == 0:
                # 0ï¼šå‚ç›´ç¿»è½¬
                flip_bboxes.append([x_min, h - y_max, x_max, h - y_min])
            elif inver == 1:
                # 1ï¼šæ°´å¹³ç¿»è½¬
                flip_bboxes.append([w - x_max, y_min, w - x_min, y_max])
            elif inver == -1:
                # -1ï¼šæ°´å¹³å‚ç›´ç¿»è½¬
                flip_bboxes.append([w - x_max, h - y_max, w - x_min, h - y_min])
        return flip_img, flip_bboxes

    # å›¾åƒå¢å¼ºæ–¹æ³•
    def dataAugment(self, img, bboxes):
        '''
        å›¾åƒå¢å¼º
        è¾“å…¥:
            img:å›¾åƒarray
            bboxes:è¯¥å›¾åƒçš„æ‰€æœ‰æ¡†åæ ‡
        è¾“å‡º:
            img:å¢å¼ºåçš„å›¾åƒ
            bboxes:å¢å¼ºåå›¾ç‰‡å¯¹åº”çš„box
        '''
        change_num = 0  # æ”¹å˜çš„æ¬¡æ•°
        # print('------')
        while change_num < 1:  # é»˜è®¤è‡³å°‘æœ‰ä¸€ç§æ•°æ®å¢å¼ºç”Ÿæ•ˆ

            if self.is_rotate_img_bbox:
                if random.random() > self.rotation_rate:  # æ—‹è½¬
                    change_num += 1
                    angle = random.uniform(-self.max_rotation_angle, self.max_rotation_angle)
                    scale = random.uniform(0.7, 0.8)
                    img, bboxes = self._rotate_img_bbox(img, bboxes, angle, scale)

            if self.is_shift_pic_bboxes:
                if random.random() < self.shift_rate:  # å¹³ç§»
                    change_num += 1
                    img, bboxes = self._shift_pic_bboxes(img, bboxes)

            if self.is_changeLight:
                if random.random() > self.change_light_rate:  # æ”¹å˜äº®åº¦
                    change_num += 1
                    img = self._changeLight(img)

            if self.is_addNoise:
                if random.random() < self.add_noise_rate:  # åŠ å™ªå£°
                    change_num += 1
                    img = self._addNoise(img)
            if self.is_cutout:
                if random.random() < self.cutout_rate:  # cutout
                    change_num += 1
                    img = self._cutout(img, bboxes, length=self.cut_out_length, n_holes=self.cut_out_holes,
                                       threshold=self.cut_out_threshold)
            if self.is_filp_pic_bboxes:
                if random.random() < self.flip_rate:  # ç¿»è½¬
                    change_num += 1
                    img, bboxes = self._filp_pic_bboxes(img, bboxes)

        return img, bboxes


# xmlè§£æå·¥å…·
class ToolHelper():
    # ä»xmlæ–‡ä»¶ä¸­æå–bounding boxä¿¡æ¯, æ ¼å¼ä¸º[[x_min, y_min, x_max, y_max, name]]
    def parse_xml(self, path):
        '''
        è¾“å…¥ï¼š
            xml_path: xmlçš„æ–‡ä»¶è·¯å¾„
        è¾“å‡ºï¼š
            ä»xmlæ–‡ä»¶ä¸­æå–bounding boxä¿¡æ¯, æ ¼å¼ä¸º[[x_min, y_min, x_max, y_max, name]]
        '''
        tree = ET.parse(path)
        root = tree.getroot()
        objs = root.findall('object')
        coords = list()
        for ix, obj in enumerate(objs):
            name = obj.find('name').text
            box = obj.find('bndbox')
            x_min = int(box[0].text)
            y_min = int(box[1].text)
            x_max = int(box[2].text)
            y_max = int(box[3].text)
            coords.append([x_min, y_min, x_max, y_max, name])
        return coords

    # ä¿å­˜å›¾ç‰‡ç»“æœ
    def save_img(self, file_name, save_folder, img):
        cv2.imwrite(os.path.join(save_folder, file_name), img)

    # ä¿æŒxmlç»“æœ
    def save_xml(self, file_name, save_folder, img_info, height, width, channel, bboxs_info):
        '''
        :param file_name:æ–‡ä»¶å
        :param save_folder:#ä¿å­˜çš„xmlæ–‡ä»¶çš„ç»“æœ
        :param height:å›¾ç‰‡çš„ä¿¡æ¯
        :param width:å›¾ç‰‡çš„å®½åº¦
        :param channel:é€šé“
        :return:
        '''
        folder_name, img_name = img_info  # å¾—åˆ°å›¾ç‰‡çš„ä¿¡æ¯

        E = objectify.ElementMaker(annotate=False)

        anno_tree = E.annotation(
            E.folder(folder_name),
            E.filename(img_name),
            E.path(os.path.join(folder_name, img_name)),
            E.source(
                E.database('Unknown'),
            ),
            E.size(
                E.width(width),
                E.height(height),
                E.depth(channel)
            ),
            E.segmented(0),
        )

        labels, bboxs = bboxs_info  # å¾—åˆ°è¾¹æ¡†å’Œæ ‡ç­¾ä¿¡æ¯
        for label, box in zip(labels, bboxs):
            anno_tree.append(
                E.object(
                    E.name(label),
                    E.pose('Unspecified'),
                    E.truncated('0'),
                    E.difficult('0'),
                    E.bndbox(
                        E.xmin(box[0]),
                        E.ymin(box[1]),
                        E.xmax(box[2]),
                        E.ymax(box[3])
                    )
                ))

        etree.ElementTree(anno_tree).write(os.path.join(save_folder, file_name), pretty_print=True)


if __name__ == '__main__':

    need_aug_num = 5  # æ¯å¼ å›¾ç‰‡éœ€è¦å¢å¼ºçš„æ¬¡æ•°

    is_endwidth_dot = True  # æ–‡ä»¶æ˜¯å¦ä»¥.jpgæˆ–è€…pngç»“å°¾

    dataAug = DataAugmentForObjectDetection()  # æ•°æ®å¢å¼ºå·¥å…·ç±»

    toolhelper = ToolHelper()  # å·¥å…·

    # è·å–ç›¸å…³å‚æ•°
    parser = argparse.ArgumentParser()
    parser.add_argument('--source_img_path', type=str, default='D:\@Graduation\enhance\images')
    parser.add_argument('--source_xml_path', type=str, default='D:\@Graduation\enhance\labels')
    parser.add_argument('--save_img_path', type=str, default='D:\@Graduation\enhance\images2')
    parser.add_argument('--save_xml_path', type=str, default='D:\@Graduation\enhance\Annotations2')
    args = parser.parse_args()
    source_img_path = args.source_img_path  # å›¾ç‰‡åŸå§‹ä½ç½®
    source_xml_path = args.source_xml_path  # xmlçš„åŸå§‹ä½ç½®

    save_img_path = args.save_img_path  # å›¾ç‰‡å¢å¼ºç»“æœä¿å­˜æ–‡ä»¶
    save_xml_path = args.save_xml_path  # xmlå¢å¼ºç»“æœä¿å­˜æ–‡ä»¶

    # å¦‚æœä¿å­˜æ–‡ä»¶å¤¹ä¸å­˜åœ¨å°±åˆ›å»º
    if not os.path.exists(save_img_path):
        os.mkdir(save_img_path)

    if not os.path.exists(save_xml_path):
        os.mkdir(save_xml_path)

    for parent, _, files in os.walk(source_img_path):
        files.sort()
        for file in files:
            cnt = 0
            pic_path = os.path.join(parent, file)
            xml_path = os.path.join(source_xml_path, file[:-4] + '.xml')
            values = toolhelper.parse_xml(xml_path)  # è§£æå¾—åˆ°boxä¿¡æ¯ï¼Œæ ¼å¼ä¸º[[x_min,y_min,x_max,y_max,name]]
            coords = [v[:4] for v in values]  # å¾—åˆ°æ¡†
            labels = [v[-1] for v in values]  # å¯¹è±¡çš„æ ‡ç­¾

            # å¦‚æœå›¾ç‰‡æ˜¯æœ‰åç¼€çš„
            if is_endwidth_dot:
                # æ‰¾åˆ°æ–‡ä»¶çš„æœ€ååå­—
                dot_index = file.rfind('.')
                _file_prefix = file[:dot_index]  # æ–‡ä»¶åçš„å‰ç¼€
                _file_suffix = file[dot_index:]  # æ–‡ä»¶åçš„åç¼€
            img = cv2.imread(pic_path)

            # show_pic(img, coords)  # æ˜¾ç¤ºåŸå›¾
            while cnt < need_aug_num:  # ç»§ç»­å¢å¼º
                auged_img, auged_bboxes = dataAug.dataAugment(img, coords)
                auged_bboxes_int = np.array(auged_bboxes).astype(np.int32)
                height, width, channel = auged_img.shape  # å¾—åˆ°å›¾ç‰‡çš„å±æ€§
                img_name = '{}_{}{}'.format(_file_prefix, cnt + 1, _file_suffix)  # å›¾ç‰‡ä¿å­˜çš„ä¿¡æ¯
                toolhelper.save_img(img_name, save_img_path,
                                    auged_img)  # ä¿å­˜å¢å¼ºå›¾ç‰‡

                toolhelper.save_xml('{}_{}.xml'.format(_file_prefix, cnt + 1),
                                    save_xml_path, (save_img_path, img_name), height, width, channel,
                                    (labels, auged_bboxes_int))  # ä¿å­˜xmlæ–‡ä»¶
                # show_pic(auged_img, auged_bboxes)  # å¼ºåŒ–åçš„å›¾
                print(img_name)
                cnt += 1  # ç»§ç»­å¢å¼ºä¸‹ä¸€å¼ 
```

  </details>

ä»Šå¤©ä¸æƒ³å†™äº†ï¼Œåˆé‡åˆ°ä¸€ä»¶æ‚²ä¼¤çš„äº‹æƒ…ï¼Œtmd å¼€å¯äº†æµé‡é™åˆ¶ï¼Œç»“æœ scp ä¼ æ–‡ä»¶ä¼ åˆ° 93%æ–­æ‰äº†ï¼Œæˆ‘çœŸçš„æœäº†ã€‚ï¼ˆåŸè°…æˆ‘çš„åå¿ƒæƒ…ï¼Œå†™ä¸ä¸‹å»äº†ï¼Œåˆ°å‡Œæ™¨äº†ï¼Œç´¯éº»äº†ï¼‰

## åç»­å¤šæ¨¡æ€çš„èåˆ

---

åç»­å®ŒæˆåŸºç¡€å¯è§å…‰æ¡ä»¶çš„è®­ç»ƒä¹‹åï¼Œè¿˜è¦å°è¯•è¿›è¡Œå¤šå…‰è°±çš„èåˆï¼Œæé«˜æ¨¡å‹çš„ç²¾ç¡®åº¦ã€‚

# æ€»ç»“

---

è¿™ç¯‡æ–‡ç« éšè¿›åº¦æ›´æ–°ï¼Œç”¨äºè®°å½•åœ¨æ¯•è®¾è¿‡ç¨‹ä¸­é‡åˆ°çš„å¿ƒå¾—å’Œé—®é¢˜ã€‚
