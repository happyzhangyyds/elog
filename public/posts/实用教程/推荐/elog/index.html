<!DOCTYPE html>
<html lang="zh-CN"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta name="description" content="[跨域协同]  elog&#43;notion实现md优雅备份 - https://matrixcore.life/posts/%E5%AE%9E%E7%94%A8%E6%95%99%E7%A8%8B/%E6%8E%A8%E8%8D%90/elog/">
    <meta name="author" content="MatrixCore - https://matrixcore.life/">
    
    <meta name="msvalidate.01" content="B46311949B856F2A7015F366FB3CE878" />
    <title>[跨域协同]  elog&#43;notion实现md优雅备份</title>
    <link rel="icon" type="image/png" href="/favicon.ico">
    
    <link rel="stylesheet" href="https://matrixcore.life/style.min.d252ad53a5e6b2ae6b8c6c1661107189be3668e36c8dd61697bbe008595a7e04.css">
    
    <script type="text/javascript" src="/main.js" defer></script>
    
</head>
<body class="active-animate cool">
        <div id="header"><div class="container-header">
    <div id="vars" class="container-vars" style="display: none;">
	{
		"isSingleColumnOfPostList": true,
		"hasFoldAllCodeBlocks": false,
		"svgColor": "",
		"en": false,
		"dark": true
	}
</div>
    <h1 class="title">
        
            [跨域协同]  elog&#43;notion实现md优雅备份
            
        
    </h1>

    <div class="container-breadcrumb-nav">
    
    <div class="breadcrumb-nav-bar">
        <div><a href="/"><svg t="1656411084410" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2954" width="16" height="16"><path d="M947.5 390.6l-377-290c-34.5-26.5-82.6-26.5-117.1 0l-377 290c-14 10.8-16.6 30.9-5.9 44.9 10.8 14 30.9 16.6 44.9 5.9l28.5-21.9V768c0 88.2 71.8 160 160 160h80c35.3 0 64-28.7 64-64V640c0-17.6 14.4-32 32-32h64c17.6 0 32 14.4 32 32v224c0 35.3 28.7 64 64 64h80c88.2 0 160-71.8 160-160V419.4l28.5 21.9c5.8 4.5 12.7 6.6 19.5 6.6 9.6 0 19.1-4.3 25.4-12.5 10.8-13.9 8.2-34-5.8-44.8zM816 768c0 52.9-43.1 96-96 96h-80V640c0-52.9-43.1-96-96-96h-64c-52.9 0-96 43.1-96 96v224h-80c-52.9 0-96-43.1-96-96V370.2l284.5-218.8c11.5-8.8 27.5-8.8 39 0L816 370.2V768z" fill="#6c757d" p-id="2955"></path></svg></a></div>
        <div><a href="/nav"><svg t="1656411531924" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5827" width="16" height="16"><path d="M849.59197473 125.23018519L139.22930586 391.72854662a23.35052669 23.35052669 0 0 0-14.95414244 21.65490745c-0.12257519 9.70384955 5.61801843 18.46795771 14.40255493 22.04306141l318.42928099 129.25528056 119.51057092 320.39047893c3.06437293 8.23295069 10.35758221 13.89182751 18.7335381 14.87242563l2.7170774 0.14300521a22.79893918 22.79893918 0 0 0 21.20546682-15.36272638l259.51158924-729.54564933a23.8612558 23.8612558 0 0 0-5.31158128-24.55584682 22.3290685 22.3290685 0 0 0-23.9021142-5.43415649zM793.65694081 211.64552314l-196.63064161 552.75171747-91.91077952-246.37564122-253.62799211-102.96295445 542.16941324-203.4131218z" p-id="5828" fill="#6c757d"></path></svg></a></div>
        <div><a href="/search"><svg t="1656411627509" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1730" width="14" height="14"><path d="M469.333333 85.333333c211.968 0 384 172.032 384 384s-172.032 384-384 384-384-172.032-384-384 172.032-384 384-384z m0 682.666667c164.992 0 298.666667-133.674667 298.666667-298.666667 0-165.034667-133.674667-298.666667-298.666667-298.666666-165.034667 0-298.666667 133.632-298.666666 298.666666 0 164.992 133.632 298.666667 298.666666 298.666667z m362.026667 3.029333l120.704 120.661334-60.373333 60.373333-120.661334-120.704 60.330667-60.330667z" p-id="1731" fill="#6c757d"></path></svg></a></div>
        <div><a href="/posts"><svg t="1656411724198" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5655" width="12" height="12"><path d="M811.705761 1024H212.294239c-93.1199 0-174.823046-87.570975-174.823046-187.387854V162.322018C37.471193 69.776145 112.604921 0 212.294239 0H596.190595l7.015883 5.93161c111.74388 95.479788 185.857116 170.741078 279.614824 266.093304 29.65805 30.040735 61.165743 62.122454 96.436499 97.393211l7.271006 7.334787v459.859234c-0.063781 99.816879-81.703145 187.387854-174.823046 187.387854zM212.294239 49.94033c-72.391155 0-124.882716 47.261538-124.882716 112.381688v674.290128c0 71.94469 59.507443 137.383743 124.882716 137.383743h599.411522c65.311492 0 124.882716-65.439053 124.882716-137.383743V397.417876c-32.528184-32.464404-61.73977-62.250016-89.356836-90.377328-90.951355-92.418312-163.278729-165.957521-269.601245-257.163999H212.294239z" fill="#6c757d" p-id="5656"></path><path d="M936.588477 449.526752h-212.326129c-99.753099 0-187.324073-81.703145-187.324073-174.823046V49.94033a25.002055 25.002055 0 0 1 49.94033 0v224.763376c0 65.311492 65.502834 124.882716 137.383743 124.882716h212.326129a25.002055 25.002055 0 1 1 0 49.94033z" fill="#6c757d" p-id="5657"></path></svg></a></div>
        <div><a href="/archive"><svg t="1656411795742" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7334" width="12" height="12"><path d="M884.224 522.24H504.32V141.824c0-16.896-13.824-30.72-30.72-30.72-120.32 0-233.472 47.616-317.952 134.144S26.112 445.952 29.184 566.784c2.56 114.688 49.152 222.72 131.072 304.128 81.92 81.408 189.952 128 304.64 130.56h10.24c117.76 0 227.84-45.568 312.32-128.512 86.528-85.504 133.632-199.68 132.608-321.024-0.512-2.048-1.536-29.696-35.84-29.696z m-140.288 307.712c-74.752 73.728-173.056 112.64-277.504 110.592-205.824-4.608-370.688-169.472-375.296-374.784-3.072-104.448 35.84-202.752 108.544-277.504 65.536-67.072 151.552-107.52 243.712-114.688v378.88c0 16.896 13.824 30.72 30.72 30.72 129.024 0 311.296 0 382.976 0.512-6.144 93.184-46.08 179.712-113.152 246.272z" fill="#6c757d" p-id="7335"></path><path d="M603.136 11.264c-8.192-0.512-15.872 3.072-22.016 8.704-5.632 5.632-9.216 13.824-9.216 22.016v378.88c0 16.896 13.824 30.72 30.72 30.72h378.88c16.896 0 30.72-13.824 30.72-30.72 0-223.744-183.808-407.552-409.088-409.6z m30.208 378.88V74.24c167.424 16.384 301.056 150.016 315.904 315.904h-315.904z" fill="#6c757d" p-id="7336"></path></svg></a></div>
        <div id="light-dark" style="cursor: pointer;"><a><svg t="1656411842215" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5086" width="12" height="12"><path d="M1007.492874 384.513055c-8.795694-34.58307-21.189627-67.666874-36.682043-99.05151-2.698679-5.397358-10.894667-3.498287-10.894666 2.598728v0.299853c0 32.484098-6.896624 63.868734-19.890263 92.554691-10.694764 23.488501-25.487523 45.077933-43.978471 64.068635-41.779547 42.679107-99.05151 66.967217-158.722299 67.26707-61.869712 0.299853-119.941284-24.188159-162.920244-68.966238-40.280281-41.979449-62.56937-98.251902-62.269516-156.323473 0.399804-59.270984 23.588452-114.94373 65.567901-156.823229 19.59041-19.59041 42.179351-35.082826 66.667364-46.077443C672.956643 71.166451 704.041426 64.469729 736.125719 64.469729h1.299364c6.097015 0 8.096037-8.096037 2.598728-10.794715C708.739126 37.982696 675.655322 25.488812 641.172203 16.493216 599.492607 5.598549 555.714038-0.098662 510.536154 0.001289 222.37722 0.700947-7.41029 237.38508 0.185992 525.444064c7.096526 271.667008 225.889418 490.559851 497.456474 497.856279 287.559228 7.796183 524.14341-220.891864 525.842579-508.551044 0.299853-44.977981-5.297407-88.656599-15.992171-130.236244z m-83.15929 301.552378c-22.588942 53.27392-54.873137 101.250434-95.953027 142.330323-41.179841 41.179841-89.056403 73.464036-142.330324 95.953027-55.172991 23.288599-113.744317 35.182777-174.314666 35.182777s-119.141675-11.794226-174.314666-35.182777c-53.27392-22.588942-101.250434-54.873137-142.330323-95.953027-41.179841-41.179841-73.464036-89.056403-95.953027-142.330323C75.749001 630.892442 63.954774 572.221164 63.954774 511.750767s11.794226-119.141675 35.182777-174.314666c22.588942-53.27392 54.873137-101.250434 95.953027-142.330323 41.179841-41.179841 89.056403-73.464036 142.330323-95.953027C392.593892 75.7642 451.26517 63.969974 511.735567 63.969974c13.99315 0 27.886348 0.599706 41.679596 1.89907C489.246577 118.643209 448.266638 198.704016 448.266638 288.360126c0 159.022152 128.836929 287.859081 287.859081 287.859081 89.156354 0 168.817357-40.580134 221.691473-104.149015 1.099462 13.09359 1.699168 26.387082 1.699168 39.680575 0 60.470397-11.794226 119.141675-35.182776 174.314666z" p-id="5087" fill="#6c757d"></path></svg></a></div>
        
    </div>

    
</div>

            <div id="toc">📜</div>
        
    
    
</div>
</div>
        <div id="content">















<div class="container-main 
     container-page 
">

    <div class="desc">
        
        <span>
            
            <svg t="1656736000388" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7409" width="12" height="12"><path d="M524.885333 338.986667L200.362667 663.466667c-17.28 15.274667-27.989333 36.693333-29.696 56.234666v133.76l130.730666 0.085334c22.784-1.621333 43.989333-12.245333 61.013334-31.701334l322.688-322.645333-160.213334-160.213333z m60.373334-60.330667l160.170666 160.213333 102.144-102.144a19.712 19.712 0 0 0 0-27.861333L715.093333 176.426667a19.456 19.456 0 0 0-27.605333 0L585.258667 278.613333zM701.312 85.333333c27.946667 0 54.741333 11.136 74.282667 30.848l132.309333 132.309334a105.045333 105.045333 0 0 1 0 148.565333L424.874667 879.957333c-29.824 34.346667-72.106667 55.466667-120.448 58.794667H85.333333v-42.666667l0.128-179.84c3.626667-44.970667 24.576-86.826667 56.448-114.944l485.12-485.034666A104.789333 104.789333 0 0 1 701.269333 85.333333z" p-id="7410" fill="#adb5bd"></path></svg>
            2023-10-11&nbsp;
        </span>
        <span>
            
            <svg t="1656737270708" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="23838" width="11" height="11"><path d="M824.264 95.36c0-23.859 25.043-44.16 48.902-44.16s49.714 20.301 49.714 44.16v190.08c0 23.859-19.054 52.868-42.913 52.868h-190.08c-23.859 0-46.696-25.96-46.696-49.819s22.55-46.249 46.409-46.249h82.025C702.344 175.534 610.22 155.853 512 155.853c-206.775 0-360.398 149.372-360.398 356.147 0 206.775 153.623 358.23 360.398 358.23 206.775 0 357.467-151.455 357.467-358.23 0-23.859 23.634-50.706 53.413-50.706 29.78 0 49.92 26.847 49.92 50.706 0 254.493-206.307 460.8-460.8 460.8-254.493 0-460.8-206.307-460.8-460.8C51.2 257.507 257.507 51.2 512 51.2c122.4 0 226.684 33.296 312.264 117.369 0.358 0.351 0.358-24.052 0-73.209z" p-id="23839" fill="#adb5bd"></path></svg>
            2023-10-11&nbsp;&nbsp;&nbsp;
        </span>
        <span>
            
            <svg t="1656737548689" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="33866" width="12" height="12"><path d="M832.038608 64.662657H192.030028C121.255125 64.662657 63.940169 121.98845 63.940169 192.694717v446.793671C63.940169 710.205493 121.255125 767.643272 192.030028 767.643272h133.353183a63.940169 63.940169 0 0 1 55.219742 31.576328l76.099638 129.83828c12.358154 21.093031 33.790754 31.626903 55.216129 31.626903s42.832688-10.544709 55.198067-31.619678l76.222461-129.870792a63.940169 63.940169 0 0 1 55.212517-31.551041h133.54103c70.576219 0 127.732228-57.289669 127.732227-127.800865V192.391272C959.825022 121.85479 902.643727 64.662657 832.038608 64.662657zM895.884854 639.842407A63.85347 63.85347 0 0 1 832.092795 703.703103h-133.54103a127.753903 127.753903 0 0 0-110.349172 63.09847l-76.222461 129.856342a0.274545 0.274545 0 0 1 0-0.050574h-0.032512s-0.021675 0.061411-0.032512 0.061412l-76.1466-129.85273A127.804477 127.804477 0 0 0 325.383211 703.703103H192.030028A64.207489 64.207489 0 0 1 127.880338 639.488388V192.694717A64.102729 64.102729 0 0 1 192.030028 128.602826h640.00858A63.799284 63.799284 0 0 1 895.884854 192.391272v447.451135z" fill="#adb5bd" p-id="33867"></path><path d="M608.154093 288.092004A31.970084 31.970084 0 0 0 576.184009 320.062089v160.078006l-134.650049-179.278119A31.970084 31.970084 0 0 0 384.002258 320.062089v255.760676a31.970084 31.970084 0 0 0 63.940169 0v-159.958796l134.650048 179.274507a31.970084 31.970084 0 0 0 57.531703-19.200113V320.062089a31.970084 31.970084 0 0 0-31.970085-31.970085z" fill="#adb5bd" p-id="33868"></path></svg>
            5359 字</span>&nbsp;
        <span>
            
            <svg t="1656737462334" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="32892" width="12" height="12"><path d="M512 74.666667C270.933333 74.666667 74.666667 270.933333 74.666667 512S270.933333 949.333333 512 949.333333 949.333333 753.066667 949.333333 512 753.066667 74.666667 512 74.666667z m0 810.666666c-204.8 0-373.333333-168.533333-373.333333-373.333333S307.2 138.666667 512 138.666667 885.333333 307.2 885.333333 512 716.8 885.333333 512 885.333333z" p-id="32893" fill="#adb5bd"></path><path d="M695.466667 567.466667l-151.466667-70.4V277.333333c0-17.066667-14.933333-32-32-32s-32 14.933333-32 32v238.933334c0 12.8 6.4 23.466667 19.2 29.866666l170.666667 81.066667c4.266667 2.133333 8.533333 2.133333 12.8 2.133333 12.8 0 23.466667-6.4 29.866666-19.2 6.4-14.933333 0-34.133333-17.066666-42.666666z" p-id="32894" fill="#adb5bd"></path></svg>
            11 分钟</span>
            <div class="container-ctgtag">
	<div class="taxonomy">
		
		<div class="ctg">
			
			
		</div>
		<div class="tag">
			
			 - 
			
			<a href="/tags/%E5%AE%9E%E7%94%A8%E6%95%99%E7%A8%8B">实用教程</a>
			
			<a href="/tags/%E6%8E%A8%E8%8D%90">推荐</a>
			
		</div>
	</div>
</div>
        
    </div>
    
    <div class="toc">
        
        <div class="page-operation">
            <div><a href="#"><img src="/imgs/icons/arrow-up-circle.svg" alt=""></a></div>
            <div><a href="https://matrixcore.life/posts/%E6%83%85%E7%BB%AA%E8%A1%A8%E8%BE%BE/communication/"><img src="/imgs/icons/arrow-left-circle.svg" alt=""></a></div>
            <div><a href="https://matrixcore.life/posts/%E6%83%85%E7%BB%AA%E8%A1%A8%E8%BE%BE/joker/"><img src="/imgs/icons/arrow-right-circle.svg" alt=""></a></div>
        </div>
        
        <nav id="TableOfContents">
  <ul>
    <li><a href="#一备份文件夹及环境配置">一、备份文件夹及环境配置</a></li>
    <li><a href="#二正确进行参数配置">二、正确进行参数配置</a></li>
    <li><a href="#三合适的网络条件">三、合适的网络条件</a></li>
    <li><a href="#四进阶操作自动备份">四、进阶操作，自动备份</a>
      <ul>
        <li><a href="#原理介绍">原理介绍</a></li>
        <li><a href="#关联-slacknotion">关联 slack+notion</a></li>
        <li><a href="#pipedream-配置">pipedream 配置</a></li>
        <li><a href="#安装打包环境">安装打包环境</a></li>
        <li><a href="#调试-github-自动化脚本">调试 github 自动化脚本</a></li>
        <li><a href="#放开-actions-的写入权限">放开 actions 的写入权限</a></li>
        <li><a href="#脚本触发">脚本触发</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#小彩蛋">小彩蛋</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>

    <div class='content  content '>
        <h1 id="前言">前言</h1>
<hr>
<p>前几天吃午饭的时候，突然想到一件事情，就是关于博客备份的事情。
之前为了对高数 18 讲进行全部重新 CDN 加速，一直用的都是 notion 自带的导出为 markdown 的功能，但是如果数据一多，速度就很慢，而且一个一个导出很费时间。
昨天晚上和今天尝试并使用了 elog，实现了 notion 文章自动批量下载到本地，并根据自定义的数据库属性进行合适的归档。
首先非常感谢这个想法的启蒙博主：某中二的黑科技研究中心
文章标题及链接：<a href="https://darkreunion.tech/article/backup-notion-to-github?giscus=5b1855710a9073bbb30d3264lzzxL%2FY5boFMZEtzfT2uvrsTkpO815dTCl%2BcFCsI%2FwZTnmkVo1SjQB2CllPRsX9pkEFoeAZ77J%2FviSyilYpOqYYX%2FGm9rbQWTk0T8J0bqUaJf4Q%2BJl9YANenxts%3D"> </a><a href="https://darkreunion.tech/article/backup-notion-to-github?giscus=5b1855710a9073bbb30d3264lzzxL%2FY5boFMZEtzfT2uvrsTkpO815dTCl%2BcFCsI%2FwZTnmkVo1SjQB2CllPRsX9pkEFoeAZ77J%2FviSyilYpOqYYX%2FGm9rbQWTk0T8J0bqUaJf4Q%2BJl9YANenxts%3D"><strong>备份 Notion 文档到 Github</strong></a></p>
<h1 id="正文">正文</h1>
<hr>
<p>实践的过程并不顺利，甚至还有些小艰难，作为纯技术小白，以下记录我的一些踩坑经历。</p>
<p>首先从阅读<a href="https://elog.1874.cool/">技术文档</a>开始。</p>
<h2 id="一备份文件夹及环境配置">一、备份文件夹及环境配置</h2>
<hr>
<p>导航到技术文档的<a href="https://elog.1874.cool/notion/start">快速开始</a>，使用 vscode 创建备份文件夹并开始环境配置。</p>
<p>⚠️ 请注意环境需要正确安装，理论上安装环境的时间在 2-3 分钟左右。</p>
<p>然后对项目进行初始化配置，生成<code>elog.config.js</code>以及<code>.elog.env</code>两个文件，接下来就是进入<a href="https://elog.1874.cool/notion/fe8ywmt999gon12w">配置详情</a>，配置相应的参数。
  ⚠️ 请注意，将您的.elog.env 文件列入 git 的忽略跟踪</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>使用`.gitignore` 文件：创建一个名为 <span style="color:#d14">`.gitignore`</span> 的文件，并在其中列出你想要隐藏的文件或文件夹的名称。在这个文件中，你可以使用通配符或模式来指定要忽略的文件类型或文件夹。当你将 <span style="color:#d14">`.gitignore`</span> 文件提交到 GitHub 仓库时，Git 将忽略这些文件，不会将它们包含在版本控制中。
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>请注意，`.gitignore` 文件只能隐藏未被跟踪的文件。如果某个文件已经被 Git 跟踪并提交到仓库中，那么即使你在 <span style="color:#d14">`.gitignore`</span> 文件中将其列为忽略项，它仍然会在仓库中可见。（解决该问题请导航到结尾彩蛋部分）
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic">## 下面是一个示例 `.gitignore` 文件的内容：</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 忽略所有 .txt 文件</span>
</span></span><span style="display:flex;"><span>*.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 忽略文件夹</span>
</span></span><span style="display:flex;"><span>my_folder/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 忽略特定文件</span>
</span></span><span style="display:flex;"><span>secret.txt
</span></span></code></pre></div><h2 id="二正确进行参数配置">二、正确进行参数配置</h2>
<hr>
<p>我希望对 notion 的数据库的文章进行批量导出，那么在配置<code>elog.config.js</code>就需要注意平台的选择。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>module.exports <span style="color:#000;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span>  write<span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>    platform<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#34;notion&#34;</span>, <span style="color:#998;font-style:italic">//注意平台的选择
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>  },
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><p>⚠️ 在最开始的时候，我忽视了平台的选择，导致报错：<code>未知的写作平台</code></p>
<p>然后是 notion 相关的配置，首先要关注自己的数据库的属性。
作者大大也提供了数据库的模板，可以参考<a href="https://elog.1874.cool/notion/gvnxobqogetukays#notion">配置流程</a>。</p>
<p>我采用的数据库是 notionnext 的数据库格式，并且 elog 也支持自定义数据库的字段。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#998;font-style:italic">//这是默认的配置
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>notion<span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>      token<span style="color:#000;font-weight:bold">:</span> process.env.NOTION_TOKEN,
</span></span><span style="display:flex;"><span>      databaseId<span style="color:#000;font-weight:bold">:</span> process.env.NOTION_DATABASE_ID,
</span></span><span style="display:flex;"><span>      filter<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">false</span>,
</span></span><span style="display:flex;"><span>      sorts<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">false</span>,
</span></span><span style="display:flex;"><span>      catalog<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">false</span>,
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//以下是我修改后针对notionnext数据库的配置
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>notion<span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>      token<span style="color:#000;font-weight:bold">:</span> process.env.NOTION_TOKEN,
</span></span><span style="display:flex;"><span>      databaseId<span style="color:#000;font-weight:bold">:</span> process.env.NOTION_DATABASE_ID,
</span></span><span style="display:flex;"><span>      filter<span style="color:#000;font-weight:bold">:</span>  {
</span></span><span style="display:flex;"><span>        property<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;type&#39;</span>,
</span></span><span style="display:flex;"><span>        select<span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>          equals<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;Post&#39;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      sorts<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">true</span>,
</span></span><span style="display:flex;"><span>      catalog<span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>        enable<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">true</span>,
</span></span><span style="display:flex;"><span>        property<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#34;tags&#34;</span>,
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//这里我希望筛选数据库中属性type中的post，也就是发布文章，同时我也希望文章按照tags的标签进行本地归档。所以对此处进行了如下修改。
</span></span></span></code></pre></div><p>另外如果想要正确输出到指定目录，还需要注意该问题：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>deploy<span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>    platform<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;local&#39;</span>,
</span></span><span style="display:flex;"><span>    local<span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>      outputDir<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;./docs&#39;</span>,
</span></span><span style="display:flex;"><span>      filename<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;title&#39;</span>,
</span></span><span style="display:flex;"><span>      format<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;markdown&#39;</span>,
</span></span><span style="display:flex;"><span>      catalog<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">true</span>,
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//在部署平台配置项中配置deploy.local.catalog=true
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>      formatExt<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;&#39;</span>,
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//一定要记得勾选部署时候到目录选项
</span></span></span></code></pre></div><p><img src="https://bu.dusays.com/2023/10/11/65269d1bd607c.png" alt=""></p>
<p><img src="https://bu.dusays.com/2023/10/11/65269d8c5bdd1.png" alt=""></p>
<p>如果要做针对自己数据库的属性更改，请参照<a href="https://developers.notion.com/reference/post-database-query-filter"><strong>Notion API 文档 - Filter database entries</strong></a><strong>。</strong></p>
<p>接下来就是正确获取 notion 的 Integration Token 和 DatabaseId，按照<a href="https://elog.1874.cool/notion/gvnxobqogetukays#notion">配置流程</a>走就可以。</p>
<p><img src="https://bu.dusays.com/2023/10/11/65269eb157ccb.png" alt=""></p>
<p><img src="https://bu.dusays.com/2023/10/11/65269ec15fd7e.png" alt=""></p>
<h2 id="三合适的网络条件">三、合适的网络条件</h2>
<hr>
<p>在正确配置 notion 的集成和 id 之后，可以开始执行</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>elog sync -e .elog.env
</span></span></code></pre></div><p>⚠️ 注意，由于 notion api 的延时问题，校园网条件下，notion api 会经常超时，所以推荐使用手机流量。
如果一切顺利，那么您将可以看到文章被正常输入到本地目录。</p>
<h2 id="四进阶操作自动备份">四、进阶操作，自动备份</h2>
<hr>
<p>阅读技术文档<a href="https://elog.1874.cool/notion/vy55q9xwlqlsfrvk">持续集成</a></p>
<p>notion 的自动化流程有一定的起手难度。</p>
<h3 id="原理介绍">原理介绍</h3>
<hr>
<p>通过 slack 捕捉 notion 数据库字段的变化，比如“status”从“Draft”变为“Published”，那么就可以推送到 slack 的频道中，然后开始触发 pipedream，调用 github actions 的 api 进行部署。</p>
<h3 id="关联-slacknotion">关联 slack+notion</h3>
<hr>
<p>首先，需要进行 slack 注册，授权给 notion 进行关联。</p>
<p><img src="https://bu.dusays.com/2023/10/11/6526a1e54f8c2.png" alt=""></p>
<p><img src="https://bu.dusays.com/2023/10/11/6526a1f09a7e6.png" alt=""></p>
<h3 id="pipedream-配置">pipedream 配置</h3>
<hr>
<p>如果一切顺利，那么接下来进入 pipedream 的部署，将 slack 与 pipedream 进行关联，最困难的是如何配置 https 请求。</p>
<p><img src="https://bu.dusays.com/2023/10/11/6526a771a80be.png" alt=""></p>
<p>在这里我要特别感谢 DC&rsquo;s 博主，他的文章给了我启发 ：<a href="https://aaqq.cc/article/24c2897b-78f3-4f6a-b8e6-292ea60edf7c"> 定期备份 notion</a></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>https<span style="color:#000;font-weight:bold">:</span><span style="color:#998;font-style:italic">//serverless-api-elog.vercel.app/api/github?user=xxx&amp;repo=xxx&amp;event_type=xxx&amp;token=xxx
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//注意将xxx替换为自己的数据
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>https<span style="color:#000;font-weight:bold">:</span><span style="color:#998;font-style:italic">//serverless-api-elog.vercel.app/api/github?user=cyolc932&amp;repo=elog&amp;event_type=deploy&amp;token=xxx
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//例如你的github用户名，仓库名称，部署名称以及github的token
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>user<span style="color:#000;font-weight:bold">:</span> Github用户名
</span></span><span style="display:flex;"><span>repo<span style="color:#000;font-weight:bold">:</span> Github仓库名
</span></span><span style="display:flex;"><span>token<span style="color:#000;font-weight:bold">:</span> Github Token
</span></span><span style="display:flex;"><span>event_type<span style="color:#000;font-weight:bold">:</span> 配置在 Github workflows 中的repository_dispatch.types的值
</span></span></code></pre></div><p>同时参考 1874 博主的<a href="https://github.com/LetTTGACO/serverless-api">文档</a>，正确配置该请求。</p>
<p>在这个步骤中，您还要获取<a href="https://github.com/settings/tokens/">GitHub 的 token</a></p>
<p>如果这一步正确，并且 serverless api 返回<code>sussess！</code>，那么恭喜你，已经成功了一半了。</p>
<h3 id="安装打包环境">安装打包环境</h3>
<hr>
<p>接下来让我们回到 vscode 的文件夹，进行打包环境的安装</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>yarn add @elog/cli
</span></span></code></pre></div><p>在<code>package.json</code>加上如下脚本</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#34;dependencies&#34;</span><span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#d14">&#34;@elog/cli&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#34;^0.8.0&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//以下为添加的脚本
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>  <span style="color:#d14">&#34;scripts&#34;</span><span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#d14">&#34;build&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#34;yarn&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#d14">&#34;elog:init&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#34;elog init&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#d14">&#34;sync:local&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#34;elog sync -e .elog.env&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#d14">&#34;sync&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#34;elog sync&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#d14">&#34;clean&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#34;elog clean&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="调试-github-自动化脚本">调试 github 自动化脚本</h3>
<hr>
<p>接下来到了困难的阶段，配置 GitHub 的 actions，首先配置环境变量，主要是 notion 的 token 和 id，填入在第二步获得的参数。</p>
<p>路径如下：<code>设置-Secrets and variables-Actions-Secrets</code></p>
<p><img src="https://bu.dusays.com/2023/10/12/65274e6154488.png" alt=""></p>
<p>接下来创建 GitHub 的工作流：<code>.github/workflows/main.yaml</code></p>
<p>最主要的是这一步，配置完成之后，在 vscode 拉取仓库内容，进行本地和远程的同步。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#000080">name</span>:<span style="color:#bbb"> </span>配置Git用户名邮箱<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#000080">run</span>:<span style="color:#bbb"> </span>|<span style="color:#d14">
</span></span></span><span style="display:flex;"><span><span style="color:#d14">          git config --global user.name &#34;xxxx&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">          git config --global user.email &#34;xxxx&#34;</span><span style="color:#bbb">          
</span></span></span></code></pre></div><p>⚠️ 请注意，接下来不要随意在本地和远程双向修改，不然会导致冲突。</p>
<h3 id="放开-actions-的写入权限">放开 actions 的写入权限</h3>
<hr>
<p>⚠️ 同时注意放开 actions 的写入权限，在该仓库的设置，工作流里找到该选项。</p>
<p><img src="https://bu.dusays.com/2023/10/12/65274f9c74f51.png" alt=""></p>
<h3 id="脚本触发">脚本触发</h3>
<hr>
<p>如果一切顺利，当您在 notion 中将文章的状态变为“Published”时候，将会自动触发工作流，进行备份，如果遇到错误，请排查工作流的报错信息。</p>
<p><img src="https://bu.dusays.com/2023/10/11/6526a765b9ded.png" alt=""></p>
<p>最后当您二次修改文章之后再次触发，文章会进行增量更新。</p>
<h1 id="总结">总结</h1>
<hr>
<p>elog 的项目非常具有实践价值，通过该项目，不仅可以实现博客文档的整洁有序自动化的归档，而且可以兼容多平台，实现数据的自由迁移。</p>
<p>在我遇到困难的时候，离不开群主和群友的耐心解答和帮助！</p>
<blockquote>
<p>💡 <strong>特别鸣谢：<br>
🌺</strong> <a href="https://github.com/LetTTGACO/elog">1874 博主的 elog 项目及其技术文档</a><br>
🌺 <a href="https://bu.dusays.com/2023/10/12/6527510b65304.png">在自行实践遇到困难和解决的宝贵经历</a><br>
🌺 <a href="https://www.bmqy.net/2651.html#more">北门清燕</a>、<a href="https://aaqq.cc/article/24c2897b-78f3-4f6a-b8e6-292ea60edf7c">DC&rsquo;s</a>、<a href="https://www.imql.life/2023/08/12/Writing_on_The_Cloud_With_YuQue/">IMQL.LIFE</a>等群友的最佳实践文档</p>
</blockquote>
<h3 id="小彩蛋">小彩蛋</h3>
<hr>
<details>
  <summary>介绍一下slack</summary>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>Slack 是一种团队协作工具，旨在改善团队内部沟通和协作的效率。它提供了实时聊天、文件共享、通知和集成等功能，使团队成员能够更轻松地进行交流和合作。
</span></span><span style="display:flex;"><span>以下是一些 Slack 的主要特点和功能：
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">1.</span> 实时聊天：Slack 提供了实时聊天功能，团队成员可以通过文本消息、表情符号、贴图等方式进行即时交流。你可以创建不同的频道（channels）来组织讨论，例如项目频道、团队频道等。
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">2.</span> 文件共享：你可以在 Slack 上轻松共享文件，包括文档、图片、音频和视频等。这样团队成员可以方便地查看、评论和编辑这些文件。
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">3.</span> 通知和提醒：Slack 可以发送通知和提醒，包括新消息、提及你的消息、任务截止日期等。你可以通过设置来控制接收哪些通知，以确保你能及时获取重要信息。
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">4.</span> 集成和应用程序：Slack 支持与其他工具和应用程序的集成，例如 Google Drive、GitHub、Jira 等。这样你可以在 Slack 中直接访问和操作这些工具，提高工作效率。
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">5.</span> 搜索和存档：Slack 有强大的搜索功能，你可以轻松找到之前的消息、文件和链接等。此外，Slack 还会自动存档你的聊天记录，方便你随时回顾和查找。
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">6.</span> 多设备支持：你可以在电脑、手机和平板电脑等不同设备上使用 Slack，并且它们之间的聊天同步。
</span></span><span style="display:flex;"><span>   总的来说，Slack 是一个强大的团队协作工具，可以帮助团队成员更好地沟通、协作和组织工作。它已经成为许多组织和公司的首选工具之一，无论是小型团队还是大型企业都可以受益于它的功能和便利性。
</span></span></code></pre></div>  </details>
<details>
  <summary>actions的权限不够</summary>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>使用 github action 时报错 Run ad-m/github-push-action@master
</span></span><span style="display:flex;"><span>Push to branch main
</span></span><span style="display:flex;"><span>remote: Write access to repository not granted.
</span></span><span style="display:flex;"><span>fatal: unable to access &#39;[https://github.com/happyzhangyyds/elog.git/](https://github.com/happyzhangyyds/elog.git/)&#39;: The requested URL returned error: 403
</span></span><span style="display:flex;"><span>Error: Invalid exit code: 128
</span></span><span style="display:flex;"><span>at ChildProcess.&lt;<span style="color:#000080">anonymous</span>&gt; (/home/runner/work/\_actions/ad-m/github-push-action/master/start.js:30:21)
</span></span><span style="display:flex;"><span>at ChildProcess.emit (node:events:514:28)
</span></span><span style="display:flex;"><span>at maybeClose (node:internal/child_process:1105:16)
</span></span><span style="display:flex;"><span>at ChildProcess.\_handle.onexit (node:internal/child_process:305:5) {
</span></span><span style="display:flex;"><span>code: 128
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>这个错误表明您在尝试使用 GitHub Actions 运行 ad-m/github-push-action@master 时遇到了权限问题。具体来说，错误消息中提到您对存储库的写访问权限不足。
</span></span><span style="display:flex;"><span>要解决这个问题，您可以执行以下步骤：
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">1.</span> 确保您有足够的权限来对该存储库进行写操作。请确保您是该存储库的所有者或具有足够的权限来进行推送操作。
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">2.</span> 检查您在 GitHub Actions 的工作流文件中是否正确配置了凭据。您需要在工作流文件中提供正确的凭据，以便能够对存储库进行推送操作。您可以使用 GitHub 提供的 secrets 功能来安全地存储和使用凭据。确保您在工作流文件中使用正确的凭据。
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">3.</span> 如果您使用的是个人访问令牌 (Personal Access Token) 进行身份验证，请确保该令牌具有足够的权限来对存储库进行写操作。您可以在 GitHub 的个人设置中生成和管理个人访问令牌。
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">4.</span> 如果您使用的是 OAuth 应用程序进行身份验证，请确保您的应用程序已正确设置并被授权对存储库进行写操作。
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>请检查上述步骤，确认您具有正确的权限和凭据，并且已正确配置 GitHub Actions 的工作流文件。这样应该能够解决您遇到的问题。如果问题仍然存在，请提供更多的上下文和详细信息，以便我能够更好地帮助您解决问题。
</span></span></code></pre></div>  </details>
<details>
  <summary>actions的本地远程冲突</summary>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>产生了如下报错信息：Run ad-m/github-push-action@master
</span></span><span style="display:flex;"><span>Push to branch main
</span></span><span style="display:flex;"><span>error: atomic push failed for ref refs/heads/main. status: 5
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>fatal: protocol error: bad line length character: erro
</span></span><span style="display:flex;"><span>To https://github.com/happyzhangyyds/elog.git
</span></span><span style="display:flex;"><span>! [rejected] HEAD -&gt; main (fetch first)
</span></span><span style="display:flex;"><span>error: failed to push some refs to &#39;https://github.com/happyzhangyyds/elog.git&#39;
</span></span><span style="display:flex;"><span>hint: Updates were rejected because the remote contains work that you do not
</span></span><span style="display:flex;"><span>hint: have locally. This is usually caused by another repository pushing to
</span></span><span style="display:flex;"><span>hint: the same ref. If you want to integrate the remote changes, use
</span></span><span style="display:flex;"><span>hint: &#39;git pull&#39; before pushing again.
</span></span><span style="display:flex;"><span>hint: See the &#39;Note about fast-forwards&#39; in &#39;git push --help&#39; for details.
</span></span><span style="display:flex;"><span>Error: Invalid exit code: 1
</span></span><span style="display:flex;"><span>at ChildProcess.&lt;<span style="color:#000080">anonymous</span>&gt; (/home/runner/work/\_actions/ad-m/github-push-action/master/start.js:30:21)
</span></span><span style="display:flex;"><span>at ChildProcess.emit (node:events:514:28)
</span></span><span style="display:flex;"><span>at maybeClose (node:internal/child_process:1105:16)
</span></span><span style="display:flex;"><span>at ChildProcess.\_handle.onexit (node:internal/child_process:305:5) {
</span></span><span style="display:flex;"><span>code: 1
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>这个错误表明在尝试使用 GitHub Actions 运行 <span style="color:#d14">`ad-m/github-push-action@master`</span> 时遇到了推送失败的问题。根据错误消息，推送失败的原因可能是由于远程存储库包含了您本地没有的提交，导致冲突。
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>要解决这个问题，您可以执行以下步骤：
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">1.</span> 按照错误消息中的建议，运行 <span style="color:#d14">`git pull`</span> 命令来将远程存储库的更改合并到本地仓库。这将更新您的本地分支，使其包含远程存储库中的最新提交。
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   ```bash
</span></span><span style="display:flex;"><span>   git pull origin main
</span></span><span style="display:flex;"><span>   ```
</span></span></code></pre></div><ol start="2">
<li>
<p>在合并远程更改后，解决可能的冲突。如果存在冲突，您需要手动解决它们以确保代码的一致性。</p>
</li>
<li>
<p>确保您有足够的权限来对存储库进行推送操作。请确保您是该存储库的所有者或具有足够的权限来进行推送操作。</p>
</li>
<li>
<p>检查您在 GitHub Actions 的工作流文件中是否正确配置了凭据。您需要在工作流文件中提供正确的凭据，以便能够对存储库进行推送操作。您可以使用 GitHub 提供的 secrets 功能来安全地存储和使用凭据。确保您在工作流文件中使用正确的凭据。</p>
</li>
</ol>
<p>请按照上述步骤逐一检查和解决问题。如果问题仍然存在，请提供更多的上下文和详细信息，以便我能够更好地帮助您解决问题。</p>
<p>尽管您已经尝试了之前提到的解决步骤，但问题仍然存在。根据错误消息，推测可能是由于其他人在您尝试推送时同时对相同的分支进行了推送，导致冲突。</p>
<p>在这种情况下，您可以尝试以下步骤：</p>
<ol>
<li>
<p>确保您的本地仓库是干净的，没有未提交的更改。运行以下命令来查看当前的仓库状态：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git status
</span></span></code></pre></div><p>如果有未提交的更改，请先提交或取消更改，确保仓库是干净的。</p>
</li>
<li>
<p>删除本地分支 <code>main</code>，然后重新拉取远程分支 <code>main</code> 的最新状态：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git branch -D main
</span></span><span style="display:flex;"><span>git fetch origin main
</span></span><span style="display:flex;"><span>git checkout main
</span></span></code></pre></div><p>这将删除您本地的 <code>main</code> 分支，并从远程存储库中获取最新的 <code>main</code> 分支。</p>
</li>
<li>
<p>如果您在本地有重要的更改，可以创建一个新的分支来保存这些更改：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git checkout -b my_changes
</span></span></code></pre></div><p>这将创建一个名为 <code>my_changes</code> 的新分支，并将您的更改保存在该分支上。</p>
</li>
<li>
<p>现在，尝试将新分支推送到远程存储库：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git push origin my_changes
</span></span></code></pre></div><p>如果推送成功，您可以在 GitHub 上查看并比较分支，然后创建一个合并请求（Pull Request），将 <code>my_changes</code> 分支的更改合并到 <code>main</code> 分支中。</p>
</li>
</ol>
<p>请注意，如果其他人在您尝试推送时继续对相同的分支进行推送，可能仍会导致冲突。在这种情况下，您需要与其他人协调，以确保您的更改能够成功地合并到主分支中。</p>
<p>如果问题仍然存在，请提供更多的上下文信息，例如您的工作流文件、代码片段或其他相关细节，以便我能够更好地帮助您解决问题。</p>
<pre tabindex="0"><code>


  &lt;/details&gt;


&lt;details&gt;
  &lt;summary&gt;解决环境变量可见性问题&lt;/summary&gt;


```markdown
如果某个文件已经被 Git 跟踪并提交到仓库中，即使你在 `.gitignore` 文件中将其列为忽略项，它仍然会在仓库中可见。要解决这个问题，你需要执行以下步骤：

1. 首先，从 Git 仓库中删除已经跟踪的文件。可以使用以下命令将文件从 Git 仓库中删除，但保留在本地文件系统中：
</code></pre><p>git rm &ndash;cached <file></p>
<pre tabindex="0"><code>
将 `&lt;file&gt;` 替换为要从 Git 仓库中删除的文件的路径。

2. 然后，将删除的文件添加到 `.gitignore` 文件中，以确保将来不会再次将其纳入版本控制。在 `.gitignore` 文件中添加文件路径或模式，例如：
</code></pre><file>
```
<ol start="3">
<li>最后，提交对 <code>.gitignore</code> 文件和已删除文件的更改：</li>
</ol>
<pre tabindex="0"><code>git add .gitignore
git commit -m &#34;Remove and ignore the specified file&#34;
</code></pre><p>这样，已删除的文件将不再出现在 Git 仓库的历史记录中，并且在将来的提交中也不会被包含。</p>
<p>请注意，这些步骤仅会将文件从 Git 仓库中删除，并阻止将来的提交。如果你希望完全从仓库中删除文件的所有痕迹，你可能需要执行其他操作，如修改 Git 的历史记录。这种情况下，建议谨慎操作，并在进行任何重要操作之前备份你的仓库。</p>
<pre tabindex="0"><code>


  &lt;/details&gt;


&lt;details&gt;
  &lt;summary&gt;如何删除git的历史痕迹&lt;/summary&gt;


```markdown
要删除 Git 仓库中的文件的所有痕迹，包括历史记录和提交信息，可以按照以下步骤进行操作：

1. 首先，确保你备份了重要的文件和仓库，以防止意外数据丢失。

2. 使用 `git filter-branch` 命令来修改 Git 的历史记录。这个命令可以重写提交历史，并删除指定文件的所有痕迹。以下是一个示例命令：
</code></pre><p>git filter-branch &ndash;force &ndash;index-filter &lsquo;git rm &ndash;cached &ndash;ignore-unmatch <file>&rsquo; &ndash;prune-empty &ndash;tag-name-filter cat &ndash; &ndash;all</p>
<pre tabindex="0"><code>
将 `&lt;file&gt;` 替换为要删除痕迹的文件的路径。这个命令将遍历所有提交，并从中删除指定文件的所有痕迹。

3. 执行该命令后，Git 将会重写历史记录。这可能需要一些时间，具体取决于你的仓库大小和提交数量。在完成后，Git 会显示重写的提交数量。

4. 接下来，使用 `git push --force` 命令将修改后的历史记录推送到远程仓库。请注意，这个命令会强制推送修改后的历史记录，因此请确保你在进行此操作之前已经备份了重要的数据。
</code></pre><p>git push &ndash;force origin <branch-name></p>
<pre tabindex="0"><code>
将 `&lt;branch-name&gt;` 替换为你要推送的分支名称。

这样，指定文件的所有痕迹将从 Git 仓库的历史记录中完全删除。

请注意，这个操作是不可逆的，并且会影响到与指定文件相关的所有提交和分支。因此，在执行此操作之前，请务必谨慎，并确保你理解操作的影响。
</code></pre>  </details>

    </div>

    

    

    <div class="container-prevnext">
    <div><a href="https://matrixcore.life/posts/%E6%83%85%E7%BB%AA%E8%A1%A8%E8%BE%BE/communication/">← [自我批评] 缺乏人际交往的艺术 </a></div>
    <div><a href="https://matrixcore.life/posts/%E6%83%85%E7%BB%AA%E8%A1%A8%E8%BE%BE/joker/">[欲拒还迎] 荒诞艺术中的璀璨之花  →</a></div>
</div>
    
    

    
</div>

        </div>
        <div id="footer"><div class="container-footer">
    
    <a href="//beian.miit.gov.cn" target="_blank">
        
        萌ICP备20241020号
        
    </a>
    <a id="s" href="/secrets">&nbsp;</a>
    
</div></div>
    </body>
</html>
